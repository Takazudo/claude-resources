"use strict";(self.webpackChunkclaude_code_doc_site=self.webpackChunkclaude_code_doc_site||[]).push([[4786],{3351(e,s,n){n.d(s,{R:()=>i,x:()=>c});var l=n(2128);const t={},r=l.createContext(t);function i(e){const s=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),l.createElement(r.Provider,{value:s},e.children)}},4580(e,s,n){n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"claude/skills/headless-browser","title":"headless-browser","description":"Browser automation skill with two efficiency tiers. Tier 1: lightweight headless-check.js for quick checks, screenshots, error detection. Tier 2: playwright-cli for interactions (click, fill, navigate...","source":"@site/docs/claude/skills/headless-browser.mdx","sourceDirName":"claude/skills","slug":"/claude/skills/headless-browser","permalink":"/docs/claude/skills/headless-browser","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":null,"lastUpdatedAt":null,"frontMatter":{"title":"headless-browser","description":"Browser automation skill with two efficiency tiers. Tier 1: lightweight headless-check.js for quick checks, screenshots, error detection. Tier 2: playwright-cli for interactions (click, fill, navigate..."},"sidebar":"claudeSidebar","previous":{"title":"git-worktree-develop","permalink":"/docs/claude/skills/git-worktree-develop"},"next":{"title":"jlcpcb-bom-generate-from-kicad","permalink":"/docs/claude/skills/jlcpcb-bom-generate-from-kicad"}}');var t=n(7900),r=n(3351);const i={title:"headless-browser",description:"Browser automation skill with two efficiency tiers. Tier 1: lightweight headless-check.js for quick checks, screenshots, error detection. Tier 2: playwright-cli for interactions (click, fill, navigate..."},c="headless-browser",o={},a=[{value:"Decision Tree",id:"decision-tree",level:2},{value:"Tier 1: Lightweight Checks (headless-check.js)",id:"tier-1-lightweight-checks-headless-checkjs",level:2},{value:"Commands",id:"commands",level:3},{value:"Output",id:"output",level:3},{value:"Example Output",id:"example-output",level:3},{value:"Tier 2: Interactive Operations (playwright-cli)",id:"tier-2-interactive-operations-playwright-cli",level:2},{value:"Command Pattern",id:"command-pattern",level:3},{value:"Core Commands",id:"core-commands",level:3},{value:"Session Management",id:"session-management",level:3},{value:"Workflow Example",id:"workflow-example",level:3},{value:"When to Use What",id:"when-to-use-what",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Technical Notes",id:"technical-notes",level:2}];function d(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"headless-browser",children:"headless-browser"})}),"\n",(0,t.jsx)(s.admonition,{title:"Bundled Resources",type:"info",children:(0,t.jsx)(s.p,{children:"This skill includes: scripts"})}),"\n",(0,t.jsx)(s.h1,{id:"headless-browser-skill",children:"Headless Browser Skill"}),"\n",(0,t.jsx)(s.p,{children:"Browser automation with two efficiency tiers for optimal token usage."}),"\n",(0,t.jsx)(s.h2,{id:"decision-tree",children:"Decision Tree"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:"Need browser automation?\n    |\n    +-- Just checking page health/errors/screenshot?\n    |       --\x3e Tier 1: headless-check.js (fastest, lowest tokens)\n    |\n    +-- Need to interact (click, fill, navigate)?\n    |       --\x3e Tier 2: playwright-cli (medium tokens)\n    |\n    +-- Need persistent context, rich introspection, or very complex scenarios?\n            --\x3e MCP Playwright (highest capability, higher tokens)\n"})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"tier-1-lightweight-checks-headless-checkjs",children:"Tier 1: Lightweight Checks (headless-check.js)"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Best for:"})," Quick health checks, screenshot capture, error detection"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Script:"})," ",(0,t.jsx)(s.code,{children:"~/.claude/skills/headless-browser/scripts/headless-check.js"})]}),"\n",(0,t.jsx)(s.h3,{id:"commands",children:"Commands"}),"\n",(0,t.jsx)(s.p,{children:"Basic check (recommended for error detection):"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"node ~/.claude/skills/headless-browser/scripts/headless-check.js --url <URL> --no-block-resources\n"})}),"\n",(0,t.jsx)(s.p,{children:"Quick check (faster, but may miss font/image errors):"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"node ~/.claude/skills/headless-browser/scripts/headless-check.js --url <URL>\n"})}),"\n",(0,t.jsx)(s.p,{children:"With screenshot:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"node ~/.claude/skills/headless-browser/scripts/headless-check.js --url <URL> --screenshot viewport --no-block-resources\nnode ~/.claude/skills/headless-browser/scripts/headless-check.js --url <URL> --screenshot full --no-block-resources\n"})}),"\n",(0,t.jsx)(s.p,{children:"Options:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--timeout &lt;ms&gt;"})," - Timeout (default: 15000)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--wait-until load|networkidle|domcontentloaded"})," - Wait strategy"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--no-javascript"})," - Disable JavaScript"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--no-block-resources"})," - Load all resources (recommended for accurate error detection)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:'--user-agent "..."'})," - Custom user agent"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Important:"})," Always use ",(0,t.jsx)(s.code,{children:"--no-block-resources"})," when checking for errors. Without it, fonts and images are blocked for speed, which can cause false ",(0,t.jsx)(s.code,{children:"net::ERR_FAILED"})," errors or miss real resource loading failures."]}),"\n",(0,t.jsx)(s.h3,{id:"output",children:"Output"}),"\n",(0,t.jsx)(s.p,{children:"JSON with:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"title"}),", ",(0,t.jsx)(s.code,{children:"statusCode"}),", ",(0,t.jsx)(s.code,{children:"finalUrl"}),", ",(0,t.jsx)(s.code,{children:"durationMs"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"hasErrors"})," - Boolean error indicator"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"console"})," - Console messages (truncated, collapsed)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"pageErrors"})," - JavaScript errors"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"networkErrors"})," - Failed requests"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"metrics"})," - Performance timing"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"screenshot"})," - File path if captured"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"example-output",children:"Example Output"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{children:'{\n  "url": "https://example.com",\n  "title": "Example Domain",\n  "statusCode": 200,\n  "durationMs": 1234,\n  "hasErrors": false,\n  "console": { "entries": [], "total": 0 },\n  "pageErrors": [],\n  "screenshot": { "path": "__inbox/headless-screenshots/screenshot-2025-01-28.png" }\n}\n'})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"tier-2-interactive-operations-playwright-cli",children:"Tier 2: Interactive Operations (playwright-cli)"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Best for:"})," Clicking, form filling, navigation, multi-step automation"]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"No installation required"})," - uses ",(0,t.jsx)(s.code,{children:"pnpm dlx"})," to run latest version on-demand."]}),"\n",(0,t.jsx)(s.h3,{id:"command-pattern",children:"Command Pattern"}),"\n",(0,t.jsx)(s.p,{children:"All commands use this pattern:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"pnpm dlx @playwright/cli@latest <command> [options]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"core-commands",children:"Core Commands"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'# Navigation\npnpm dlx @playwright/cli@latest open <url>           # Open URL (headless)\npnpm dlx @playwright/cli@latest open <url> --headed  # Open with visible browser\npnpm dlx @playwright/cli@latest close                # Close page\npnpm dlx @playwright/cli@latest go-back              # Navigate back\npnpm dlx @playwright/cli@latest go-forward           # Navigate forward\npnpm dlx @playwright/cli@latest reload               # Reload page\n\n# Get Element References (IMPORTANT: run this first!)\npnpm dlx @playwright/cli@latest snapshot             # Get element refs\n\n# Interactions (use refs from snapshot)\npnpm dlx @playwright/cli@latest click <ref>          # Click element\npnpm dlx @playwright/cli@latest dblclick <ref>       # Double-click\npnpm dlx @playwright/cli@latest fill <ref> <text>    # Fill input field\npnpm dlx @playwright/cli@latest type <text>          # Type into focused element\npnpm dlx @playwright/cli@latest select <ref> <val>   # Select dropdown option\npnpm dlx @playwright/cli@latest check <ref>          # Check checkbox\npnpm dlx @playwright/cli@latest uncheck <ref>        # Uncheck checkbox\npnpm dlx @playwright/cli@latest hover <ref>          # Hover over element\npnpm dlx @playwright/cli@latest drag <start> <end>   # Drag and drop\n\n# Screenshots & Output\npnpm dlx @playwright/cli@latest screenshot           # Capture viewport\npnpm dlx @playwright/cli@latest screenshot <ref>     # Capture specific element\npnpm dlx @playwright/cli@latest pdf                  # Save as PDF\n\n# Keyboard & Mouse\npnpm dlx @playwright/cli@latest press <key>          # Press key (Enter, Tab, etc.)\npnpm dlx @playwright/cli@latest keydown <key>        # Key down\npnpm dlx @playwright/cli@latest keyup <key>          # Key up\n\n# Debugging\npnpm dlx @playwright/cli@latest console              # View console messages\npnpm dlx @playwright/cli@latest console error        # View only errors\npnpm dlx @playwright/cli@latest network              # List network requests\n\n# Tabs\npnpm dlx @playwright/cli@latest tab-list             # List tabs\npnpm dlx @playwright/cli@latest tab-new <url>        # Open new tab\npnpm dlx @playwright/cli@latest tab-select <idx>     # Switch tab\npnpm dlx @playwright/cli@latest tab-close            # Close current tab\n\n# JavaScript\npnpm dlx @playwright/cli@latest eval "() => document.title"  # Evaluate JS\n'})}),"\n",(0,t.jsx)(s.h3,{id:"session-management",children:"Session Management"}),"\n",(0,t.jsx)(s.p,{children:"For persistent browser sessions across commands (REQUIRED for multi-step workflows):"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# Use named session - browser stays open between commands\npnpm dlx @playwright/cli@latest --session mytest open https://example.com\npnpm dlx @playwright/cli@latest --session mytest snapshot\npnpm dlx @playwright/cli@latest --session mytest click ref123\npnpm dlx @playwright/cli@latest --session mytest screenshot\n\n# List/manage sessions\npnpm dlx @playwright/cli@latest session-list\npnpm dlx @playwright/cli@latest session-stop mytest\npnpm dlx @playwright/cli@latest session-stop-all\npnpm dlx @playwright/cli@latest session-delete mytest\n"})}),"\n",(0,t.jsx)(s.h3,{id:"workflow-example",children:"Workflow Example"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'# 1. Open page with session (keeps browser open)\npnpm dlx @playwright/cli@latest --session todo open https://demo.playwright.dev/todomvc --headed\n\n# 2. Get element references\npnpm dlx @playwright/cli@latest --session todo snapshot\n# Output shows refs like: [ref=e5] input.new-todo\n\n# 3. Interact using refs\npnpm dlx @playwright/cli@latest --session todo fill e5 "Buy groceries"\npnpm dlx @playwright/cli@latest --session todo press Enter\n\n# 4. Verify\npnpm dlx @playwright/cli@latest --session todo snapshot\n\n# 5. Screenshot result\npnpm dlx @playwright/cli@latest --session todo screenshot\n\n# 6. Cleanup\npnpm dlx @playwright/cli@latest --session todo close\n'})}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"when-to-use-what",children:"When to Use What"}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"Task"}),(0,t.jsx)(s.th,{children:"Recommended Tier"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Check if page loads"}),(0,t.jsx)(s.td,{children:"Tier 1"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Capture screenshot"}),(0,t.jsx)(s.td,{children:"Tier 1"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Check for console errors"}),(0,t.jsxs)(s.td,{children:["Tier 1 + ",(0,t.jsx)(s.code,{children:"--no-block-resources"})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Check network failures"}),(0,t.jsxs)(s.td,{children:["Tier 1 + ",(0,t.jsx)(s.code,{children:"--no-block-resources"})]})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Click a button"}),(0,t.jsx)(s.td,{children:"Tier 2"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Fill a form"}),(0,t.jsx)(s.td,{children:"Tier 2"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Navigate through pages"}),(0,t.jsx)(s.td,{children:"Tier 2"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Test login flow"}),(0,t.jsx)(s.td,{children:"Tier 2"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Extract text after interaction"}),(0,t.jsx)(s.td,{children:"Tier 2"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Complex stateful automation"}),(0,t.jsx)(s.td,{children:"MCP Playwright"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Self-healing tests"}),(0,t.jsx)(s.td,{children:"MCP Playwright"})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:"Deep debugging with tracing"}),(0,t.jsx)(s.td,{children:"MCP Playwright / Chrome DevTools"})]})]})]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsxs)(s.ol,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Start with Tier 1"})," - If you just need to check if a page works, use headless-check.js"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Escalate to Tier 2"})," - When interactions are needed, use playwright-cli"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Use sessions"})," - For multi-step workflows, use ",(0,t.jsx)(s.code,{children:"--session"})," to maintain state"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Get refs first"})," - Always run ",(0,t.jsx)(s.code,{children:"snapshot"})," before interacting to get current element refs"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Use --headed for debugging"})," - See what's happening in the browser"]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"technical-notes",children:"Technical Notes"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Tier 1 script uses headless Chromium"}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Resource blocking:"})," By default, Tier 1 blocks images/fonts for speed. Use ",(0,t.jsx)(s.code,{children:"--no-block-resources"})," for accurate error detection (fonts/images will load, catching real failures)"]}),"\n",(0,t.jsxs)(s.li,{children:["Tier 2 uses ",(0,t.jsx)(s.code,{children:"pnpm dlx"})," - no global install needed, always runs latest version"]}),"\n",(0,t.jsxs)(s.li,{children:["Tier 2 is headless by default, use ",(0,t.jsx)(s.code,{children:"--headed"})," to see browser"]}),"\n",(0,t.jsxs)(s.li,{children:["Screenshots saved to ",(0,t.jsx)(s.code,{children:"__inbox/headless-screenshots/"})," (Tier 1) or current directory (Tier 2)"]}),"\n",(0,t.jsx)(s.li,{children:"Both tiers are more token-efficient than MCP Playwright"}),"\n",(0,t.jsxs)(s.li,{children:["First ",(0,t.jsx)(s.code,{children:"pnpm dlx"})," call may be slower (downloads package), subsequent calls are cached"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);