"use strict";(self.webpackChunkclaude_code_doc_site=self.webpackChunkclaude_code_doc_site||[]).push([[9171],{3351(e,n,i){i.d(n,{R:()=>l,x:()=>o});var r=i(2128);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},9754(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"claude/skills/claudemd-refactor","title":"claudemd-refactor","description":"Refactor and optimize CLAUDE.md files in a repository. Analyzes the existing CLAUDE.md setup, explores the repo structure, and proposes splitting or reorganizing CLAUDE.md into a hierarchical director...","source":"@site/docs/claude/skills/claudemd-refactor.mdx","sourceDirName":"claude/skills","slug":"/claude/skills/claudemd-refactor","permalink":"/docs/claude/skills/claudemd-refactor","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":null,"lastUpdatedAt":null,"frontMatter":{"title":"claudemd-refactor","description":"Refactor and optimize CLAUDE.md files in a repository. Analyzes the existing CLAUDE.md setup, explores the repo structure, and proposes splitting or reorganizing CLAUDE.md into a hierarchical director..."},"sidebar":"claudeSidebar","previous":{"title":"ASCII Circuit Diagram Golden Rules","permalink":"/docs/claude/skills/ascii-circuit-diagram-creator/golden-rules"},"next":{"title":"How Claude Code Loads CLAUDE.md Context","permalink":"/docs/claude/skills/claudemd-refactor/context-loading"}}');var t=i(7900),s=i(3351);const l={title:"claudemd-refactor",description:"Refactor and optimize CLAUDE.md files in a repository. Analyzes the existing CLAUDE.md setup, explores the repo structure, and proposes splitting or reorganizing CLAUDE.md into a hierarchical director..."},o="claudemd-refactor",d={},c=[{value:"Context Loading Reliability Hierarchy",id:"context-loading-reliability-hierarchy",level:2},{value:"Workflow",id:"workflow",level:2},{value:"Phase 1: Explore and Analyze",id:"phase-1-explore-and-analyze",level:3},{value:"Phase 2: Propose a Plan",id:"phase-2-propose-a-plan",level:3},{value:"Phase 3: Ask for User Approval",id:"phase-3-ask-for-user-approval",level:3},{value:"Phase 4: Execute the Refactoring",id:"phase-4-execute-the-refactoring",level:3},{value:"Phase 5: Verify",id:"phase-5-verify",level:3},{value:"Content Placement Rules",id:"content-placement-rules",level:2},{value:"Root CLAUDE.md (always loaded)",id:"root-claudemd-always-loaded",level:3},{value:"Directory-scoped CLAUDE.md (loaded when working in that directory)",id:"directory-scoped-claudemd-loaded-when-working-in-that-directory",level:3},{value:"What NOT to put in CLAUDE.md",id:"what-not-to-put-in-claudemd",level:3},{value:"Anti-patterns to Fix",id:"anti-patterns-to-fix",level:2},{value:"References",id:"references",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"claudemd-refactor",children:"claudemd-refactor"})}),"\n",(0,t.jsx)(n.admonition,{title:"Bundled Resources",type:"info",children:(0,t.jsxs)(n.p,{children:["This skill includes: ",(0,t.jsx)(n.a,{href:"#references",children:"references"})]})}),"\n",(0,t.jsx)(n.h1,{id:"refactor-claudemd",children:"Refactor CLAUDE.md"}),"\n",(0,t.jsx)(n.p,{children:"Analyze and refactor CLAUDE.md files in the current repository to optimize how context is delivered to Claude Code."}),"\n",(0,t.jsx)(n.h2,{id:"context-loading-reliability-hierarchy",children:"Context Loading Reliability Hierarchy"}),"\n",(0,t.jsx)(n.p,{children:"When deciding where to place information, follow this hierarchy (most to least reliable):"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Approach"}),(0,t.jsx)(n.th,{children:"Reliability"}),(0,t.jsx)(n.th,{children:"Tradeoff"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Inline in CLAUDE.md"}),(0,t.jsx)(n.td,{children:"Highest"}),(0,t.jsx)(n.td,{children:"Larger CLAUDE.md"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Directory-scoped CLAUDE.md"}),(0,t.jsx)(n.td,{children:"High"}),(0,t.jsx)(n.td,{children:"Content must be relevant to that directory"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:'Explicit "read before doing X"'}),(0,t.jsx)(n.td,{children:"Medium"}),(0,t.jsx)(n.td,{children:"Depends on Claude following the instruction"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:'Passive "refer to file"'}),(0,t.jsx)(n.td,{children:"Low"}),(0,t.jsx)(n.td,{children:"Claude may or may not read it"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Key principle"}),": Claude Code automatically loads CLAUDE.md files based on the working directory. Root CLAUDE.md is always loaded. Subdirectory CLAUDE.md files are loaded when working on files in that directory. Content in CLAUDE.md is always in context \u2014 no tool call needed."]}),"\n",(0,t.jsx)(n.h2,{id:"workflow",children:"Workflow"}),"\n",(0,t.jsx)(n.h3,{id:"phase-1-explore-and-analyze",children:"Phase 1: Explore and Analyze"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Find all existing CLAUDE.md files"})," in the repo"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Glob: **/CLAUDE.md\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Read the root CLAUDE.md"})," \u2014 understand what's currently there, measure its size"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Explore the repo structure"})," \u2014 understand the directory layout, identify logical boundaries"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"What are the major directories? (src/, docs/, scripts/, tests/, etc.)"}),"\n",(0,t.jsx)(n.li,{children:"What languages/frameworks are used?"}),"\n",(0,t.jsx)(n.li,{children:"Are there distinct subsystems with their own conventions?"}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Categorize the content"})," in the existing root CLAUDE.md into buckets:"]}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Global"}),": Project-wide info that applies everywhere (project name, tech stack, overall architecture, global conventions)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Directory-specific"}),': Rules that only apply to certain directories (e.g., "use camelCase in src/", "frontmatter required in docs/")']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Task-specific"}),': Instructions tied to specific operations (e.g., "before modifying API routes, read api-design.md")']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Redundant/outdated"}),": Content that can be removed"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"phase-2-propose-a-plan",children:"Phase 2: Propose a Plan"}),"\n",(0,t.jsx)(n.p,{children:"Present the user with a concrete proposal. Include:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.strong,{children:"Current state summary"})}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Number of CLAUDE.md files found"}),"\n",(0,t.jsx)(n.li,{children:"Root CLAUDE.md size (lines/sections)"}),"\n",(0,t.jsx)(n.li,{children:"Content categories identified"}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"2",children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Proposed CLAUDE.md structure"})," \u2014 show a tree like:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"repo/\n\u251c\u2500\u2500 CLAUDE.md              # Global: project overview, tech stack, universal conventions\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 CLAUDE.md          # Code: naming conventions, import rules, architecture patterns\n\u251c\u2500\u2500 docs/\n\u2502   \u2514\u2500\u2500 CLAUDE.md          # Docs: writing style, frontmatter, formatting rules\n\u2514\u2500\u2500 tests/\n    \u2514\u2500\u2500 CLAUDE.md          # Tests: testing conventions, fixture locations, coverage rules\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"For each proposed CLAUDE.md"}),", list:"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"What content moves there (with specific sections/lines from original)"}),"\n",(0,t.jsx)(n.li,{children:"What stays in root"}),"\n",(0,t.jsx)(n.li,{children:"Any new content needed (e.g., cross-references)"}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:'Migration of "refer to" patterns'})," \u2014 identify any passive references and propose upgrades:"]}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Passive \u2192 Inline (if content is small and critical)"}),"\n",(0,t.jsx)(n.li,{children:'Passive \u2192 Explicit trigger ("Before modifying X, read Y")'}),"\n",(0,t.jsx)(n.li,{children:"Keep as passive (only if truly optional background info)"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"phase-3-ask-for-user-approval",children:"Phase 3: Ask for User Approval"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"IMPORTANT"}),": Do NOT proceed without explicit user approval. Present the plan and ask:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Does the proposed structure make sense for this repo?"}),"\n",(0,t.jsx)(n.li,{children:"Should any content stay in root instead of being split?"}),"\n",(0,t.jsx)(n.li,{children:"Are there directories that should have their own CLAUDE.md that weren't identified?"}),"\n",(0,t.jsx)(n.li,{children:"Any content that should be removed entirely?"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"phase-4-execute-the-refactoring",children:"Phase 4: Execute the Refactoring"}),"\n",(0,t.jsx)(n.p,{children:"After approval:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Create directory-scoped CLAUDE.md files"})," with the approved content"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Trim the root CLAUDE.md"})," \u2014 remove content that was moved to subdirectories"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Upgrade passive references"}),' \u2014 replace "refer to X" with inline content or explicit triggers']}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Add cross-references where needed"})," \u2014 if root CLAUDE.md needs to mention that subdirectory rules exist"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"phase-5-verify",children:"Phase 5: Verify"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Read each created/modified CLAUDE.md to verify correctness"}),"\n",(0,t.jsx)(n.li,{children:"Ensure no critical information was lost"}),"\n",(0,t.jsx)(n.li,{children:"Check that the root CLAUDE.md is noticeably smaller but still contains all global info"}),"\n",(0,t.jsx)(n.li,{children:"Present a summary of changes to the user"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"content-placement-rules",children:"Content Placement Rules"}),"\n",(0,t.jsx)(n.p,{children:"Use these rules to decide where content belongs:"}),"\n",(0,t.jsx)(n.h3,{id:"root-claudemd-always-loaded",children:"Root CLAUDE.md (always loaded)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Project name and purpose"}),"\n",(0,t.jsx)(n.li,{children:"Tech stack overview"}),"\n",(0,t.jsx)(n.li,{children:"Universal coding conventions (applies to ALL code)"}),"\n",(0,t.jsx)(n.li,{children:"Git/commit conventions"}),"\n",(0,t.jsx)(n.li,{children:"CI/CD and deployment notes"}),"\n",(0,t.jsx)(n.li,{children:"Links to key documentation"}),"\n",(0,t.jsx)(n.li,{children:"Cross-references to subdirectory CLAUDE.md files"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"directory-scoped-claudemd-loaded-when-working-in-that-directory",children:"Directory-scoped CLAUDE.md (loaded when working in that directory)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Language/framework-specific conventions for that directory"}),"\n",(0,t.jsx)(n.li,{children:"File naming and organization rules specific to that area"}),"\n",(0,t.jsx)(n.li,{children:"Import/export patterns"}),"\n",(0,t.jsx)(n.li,{children:"Testing patterns specific to that area"}),"\n",(0,t.jsx)(n.li,{children:"Build/compilation notes for that subsystem"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"what-not-to-put-in-claudemd",children:"What NOT to put in CLAUDE.md"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Content that changes frequently (use external docs with explicit read triggers)"}),"\n",(0,t.jsx)(n.li,{children:"Very long reference material (keep in separate .md files, use explicit read triggers)"}),"\n",(0,t.jsx)(n.li,{children:"Information that's obvious from the code itself"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"anti-patterns-to-fix",children:"Anti-patterns to Fix"}),"\n",(0,t.jsx)(n.p,{children:"When analyzing existing CLAUDE.md, look for and fix these anti-patterns:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:'"Refer to X for details"'})," \u2192 Inline the content or use explicit trigger"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Duplicate information"})," across multiple sections \u2192 Consolidate"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Outdated instructions"})," referencing files/dirs that don't exist \u2192 Remove"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Overly verbose explanations"})," \u2192 Condense to actionable rules"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Everything in root"})," when clear directory boundaries exist \u2192 Split"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Directory-specific rules in root"})," \u2192 Move to appropriate directory CLAUDE.md"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"/docs/claude/skills/claudemd-refactor/context-loading",children:"How Claude Code Loads CLAUDE.md Context"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);