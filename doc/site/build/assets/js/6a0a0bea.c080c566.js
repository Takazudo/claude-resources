"use strict";(self.webpackChunkclaude_code_doc_site=self.webpackChunkclaude_code_doc_site||[]).push([[205],{3351(e,s,n){n.d(s,{R:()=>t,x:()=>r});var i=n(2128);const c={},l=i.createContext(c);function t(e){const s=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:t(e.components),i.createElement(l.Provider,{value:s},e.children)}},3503(e,s,n){n.r(s),n.d(s,{assets:()=>h,contentTitle:()=>r,default:()=>d,frontMatter:()=>t,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"claude/skills/watch-ci","title":"watch-ci","description":"Watch GitHub PR CI checks and notify on completion. Use when: (1) User wants to monitor CI/CD pipeline status, (2) User says \'watch CI\', \'check CI\', \'monitor checks\', or \'wait for CI\', (3) User wants ...","source":"@site/docs/claude/skills/watch-ci.mdx","sourceDirName":"claude/skills","slug":"/claude/skills/watch-ci","permalink":"/docs/claude/skills/watch-ci","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":null,"lastUpdatedAt":null,"frontMatter":{"title":"watch-ci","description":"Watch GitHub PR CI checks and notify on completion. Use when: (1) User wants to monitor CI/CD pipeline status, (2) User says \'watch CI\', \'check CI\', \'monitor checks\', or \'wait for CI\', (3) User wants ..."},"sidebar":"claudeSidebar","previous":{"title":"subagent-tweaker","permalink":"/docs/claude/skills/subagent-tweaker"},"next":{"title":"xlsx","permalink":"/docs/claude/skills/xlsx"}}');var c=n(7900),l=n(3351);const t={title:"watch-ci",description:"Watch GitHub PR CI checks and notify on completion. Use when: (1) User wants to monitor CI/CD pipeline status, (2) User says 'watch CI', 'check CI', 'monitor checks', or 'wait for CI', (3) User wants ..."},r="watch-ci",h={},a=[{value:"Scripts",id:"scripts",level:2},{value:"Workflow",id:"workflow",level:2},{value:"Step 1: Identify the PR",id:"step-1-identify-the-pr",level:3},{value:"Step 2: Show Initial Status",id:"step-2-show-initial-status",level:3},{value:"Step 3: Poll Loop",id:"step-3-poll-loop",level:3},{value:"Step 4: All Checks Passed",id:"step-4-all-checks-passed",level:3},{value:"Step 5: CI Check Failed",id:"step-5-ci-check-failed",level:3},{value:"Notes",id:"notes",level:2}];function o(e){const s={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.header,{children:(0,c.jsx)(s.h1,{id:"watch-ci",children:"watch-ci"})}),"\n",(0,c.jsx)(s.admonition,{title:"Bundled Resources",type:"info",children:(0,c.jsx)(s.p,{children:"This skill includes: scripts"})}),"\n",(0,c.jsx)(s.h1,{id:"watch-ci-1",children:"Watch CI"}),"\n",(0,c.jsx)(s.p,{children:"Monitor GitHub PR CI checks, notify on completion via macOS system notification, and investigate failures."}),"\n",(0,c.jsx)(s.h2,{id:"scripts",children:"Scripts"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"Notification"}),": ",(0,c.jsx)(s.code,{children:"~/.claude/skills/watch-ci/scripts/notify.sh"})]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"CI Checker"}),": ",(0,c.jsx)(s.code,{children:"~/.claude/skills/watch-ci/scripts/check-ci.sh"})]}),"\n"]}),"\n",(0,c.jsx)(s.h2,{id:"workflow",children:"Workflow"}),"\n",(0,c.jsx)(s.h3,{id:"step-1-identify-the-pr",children:"Step 1: Identify the PR"}),"\n",(0,c.jsx)(s.p,{children:"Determine which PR to watch:"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"# If user provides a PR number or URL, use it directly\n# Otherwise, detect from current branch\ngh pr view --json number,title,url,headRefName --jq '{number,title,url,headRefName}'\n"})}),"\n",(0,c.jsx)(s.p,{children:"If no PR is found for the current branch, inform the user and stop."}),"\n",(0,c.jsx)(s.h3,{id:"step-2-show-initial-status",children:"Step 2: Show Initial Status"}),"\n",(0,c.jsx)(s.p,{children:"Before starting the watch loop, show the current state:"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"gh pr checks --json name,state,bucket,workflow\n"})}),"\n",(0,c.jsx)(s.p,{children:"Report to the user:"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsx)(s.li,{children:"PR number and title"}),"\n",(0,c.jsx)(s.li,{children:"Total number of checks"}),"\n",(0,c.jsx)(s.li,{children:"Current status breakdown (passed/pending/failed)"}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"step-3-poll-loop",children:"Step 3: Poll Loop"}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"IMPORTANT"}),": You must poll every 20 seconds until all checks reach a terminal state (pass or fail)."]}),"\n",(0,c.jsx)(s.p,{children:"Use this polling approach:"}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:'# Run check and capture result\nRESULT=$(bash ~/.claude/skills/watch-ci/scripts/check-ci.sh [PR_NUMBER])\necho "$RESULT"\n'})}),"\n",(0,c.jsxs)(s.p,{children:["Parse the JSON result. Based on ",(0,c.jsx)(s.code,{children:"status"}),":"]}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:(0,c.jsx)(s.code,{children:"pending"})}),": Wait 20 seconds, then check again"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"sleep 20\n"})}),"\n",(0,c.jsx)(s.p,{children:'Print a brief progress update each cycle (e.g., "Checking... 5/8 passed, 3 pending")'}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:(0,c.jsx)(s.code,{children:"pass"})}),": All checks green - proceed to Step 4 (Success)"]}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:(0,c.jsx)(s.code,{children:"fail"})}),": One or more checks failed - proceed to Step 5 (Failure)"]}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:(0,c.jsx)(s.code,{children:"error"})})," or ",(0,c.jsx)(s.strong,{children:(0,c.jsx)(s.code,{children:"no_checks"})}),": Report the issue and stop"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Keep the loop going"})," until a terminal state is reached. Do NOT give up or ask the user to check manually."]}),"\n",(0,c.jsx)(s.h3,{id:"step-4-all-checks-passed",children:"Step 4: All Checks Passed"}),"\n",(0,c.jsx)(s.p,{children:"When all CI checks pass:"}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Send system notification"}),":"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:'bash ~/.claude/skills/watch-ci/scripts/notify.sh success "All CI checks passed! PR #<number>"\n'})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsx)(s.p,{children:"Report the final status to the user with a summary of all checks."}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsx)(s.p,{children:"Done! The CI is green."}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"step-5-ci-check-failed",children:"Step 5: CI Check Failed"}),"\n",(0,c.jsx)(s.p,{children:"When one or more CI checks fail:"}),"\n",(0,c.jsxs)(s.ol,{children:["\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Send system notification"}),":"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:'bash ~/.claude/skills/watch-ci/scripts/notify.sh error "CI check failed: <check-name>. PR #<number>"\n'})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Identify which checks failed"}),":"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:'gh pr checks [PR_NUMBER] --json name,state,bucket,link --jq \'[.[] | select(.bucket == "fail" or .bucket == "cancel")]\'\n'})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Investigate the failure"})," - fetch the failed run logs:"]}),"\n",(0,c.jsx)(s.pre,{children:(0,c.jsx)(s.code,{className:"language-bash",children:"# List failed runs for this PR's branch\ngh run list --branch <branch> --status failure --limit 5 --json databaseId,name,conclusion\n\n# Get logs for the failed run\ngh run view <run-id> --log-failed\n"})}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Analyze the logs"})," and determine the root cause:"]}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsx)(s.li,{children:"Build errors: check compiler/transpiler output"}),"\n",(0,c.jsx)(s.li,{children:"Test failures: identify which tests failed and why"}),"\n",(0,c.jsx)(s.li,{children:"Lint errors: identify which files/rules are violated"}),"\n",(0,c.jsx)(s.li,{children:"Timeout: check if tests are hanging"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsxs)(s.p,{children:[(0,c.jsx)(s.strong,{children:"Fix the problem"}),":"]}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsx)(s.li,{children:"Make the necessary code changes to fix the failure"}),"\n",(0,c.jsx)(s.li,{children:"Commit the fix"}),"\n",(0,c.jsx)(s.li,{children:"Push to the PR branch"}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"Return to Step 3"})," to watch the new CI run"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(s.li,{children:["\n",(0,c.jsx)(s.p,{children:"If the fix requires user input or the failure is unclear, explain the issue and ask the user for guidance before proceeding."}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(s.h2,{id:"notes",children:"Notes"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsx)(s.li,{children:"The polling interval is 20 seconds to balance responsiveness with API rate limits"}),"\n",(0,c.jsxs)(s.li,{children:["System notifications use macOS ",(0,c.jsx)(s.code,{children:"osascript"})," (works on macOS only, degrades gracefully elsewhere)"]}),"\n",(0,c.jsxs)(s.li,{children:["The ",(0,c.jsx)(s.code,{children:"gh"})," CLI must be authenticated and have access to the repository"]}),"\n",(0,c.jsx)(s.li,{children:"If the PR has no checks configured, report this and stop"}),"\n",(0,c.jsx)(s.li,{children:"Maximum reasonable watch time: if CI has been running for over 60 minutes with no progress, warn the user"}),"\n"]})]})}function d(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,c.jsx)(s,{...e,children:(0,c.jsx)(o,{...e})}):o(e)}}}]);