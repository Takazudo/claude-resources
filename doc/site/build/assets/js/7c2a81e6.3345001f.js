"use strict";(self.webpackChunkclaude_code_doc_site=self.webpackChunkclaude_code_doc_site||[]).push([[9406],{2263(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"claude/skills/package-json-develop/patterns","title":"package.json Organization Patterns","description":"Skill: package-json-develop","source":"@site/docs/claude/skills/package-json-develop/patterns.mdx","sourceDirName":"claude/skills/package-json-develop","slug":"/claude/skills/package-json-develop/patterns","permalink":"/docs/claude/skills/package-json-develop/patterns","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":null,"lastUpdatedAt":null,"frontMatter":{"title":"package.json Organization Patterns"},"sidebar":"claudeSidebar","previous":{"title":"package-json-develop","permalink":"/docs/claude/skills/package-json-develop"},"next":{"title":"pdf-combine","permalink":"/docs/claude/skills/pdf-combine"}}');var l=s(7900),r=s(3351);const i={title:"package.json Organization Patterns"},c="package.json Organization Patterns",a={},d=[{value:"Comment Separator Keys",id:"comment-separator-keys",level:2},{value:"Format",id:"format",level:3},{value:"Example",id:"example",level:3},{value:"Suggested Section Names",id:"suggested-section-names",level:3},{value:"External Shell Scripts for Complex Commands",id:"external-shell-scripts-for-complex-commands",level:2},{value:"When to Extract",id:"when-to-extract",level:3},{value:"Shell Script Pattern",id:"shell-script-pattern",level:3},{value:"Calling from package.json",id:"calling-from-packagejson",level:3},{value:"Multi-Environment Dev Commands",id:"multi-environment-dev-commands",level:2},{value:"Namespace Prefixed Sub-Package Commands",id:"namespace-prefixed-sub-package-commands",level:2},{value:"Internal/Private Scripts",id:"internalprivate-scripts",level:2}];function o(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"packagejson-organization-patterns",children:"package.json Organization Patterns"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Skill:"})," ",(0,l.jsx)(n.a,{href:"/docs/claude/skills/package-json-develop",children:"package-json-develop"})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h1,{id:"packagejson-organization-patterns-1",children:"package.json Organization Patterns"}),"\n",(0,l.jsx)(n.h2,{id:"comment-separator-keys",children:"Comment Separator Keys"}),"\n",(0,l.jsxs)(n.p,{children:["Use ",(0,l.jsx)(n.code,{children:'"//"'})," prefix keys with descriptive section names as visual separators.",(0,l.jsx)(n.br,{}),"\n","JSON doesn't support comments, but unused keys with empty string values work as separators."]}),"\n",(0,l.jsx)(n.h3,{id:"format",children:"Format"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'"// \u2500\u2500 Section Name \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500": ""\n'})}),"\n",(0,l.jsx)(n.p,{children:"Rules:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Start with ",(0,l.jsx)(n.code,{children:'"// \u2500\u2500 "'})]}),"\n",(0,l.jsxs)(n.li,{children:["Pad with ",(0,l.jsx)(n.code,{children:"\u2500"})," characters to roughly consistent width (~50 chars total key length)"]}),"\n",(0,l.jsxs)(n.li,{children:["Value is always empty string ",(0,l.jsx)(n.code,{children:'""'})]}),"\n",(0,l.jsx)(n.li,{children:"Place before the first script in each section"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "scripts": {\n    "// \u2500\u2500 Core \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500": "",\n    "dev": "next dev",\n    "build": "next build",\n    "serve": "serve out",\n    "// \u2500\u2500 Code quality \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500": "",\n    "typecheck": "tsc --noEmit",\n    "lint": "eslint .",\n    "format": "prettier --check .",\n    "// \u2500\u2500 Testing \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500": "",\n    "test": "jest",\n    "test:e2e": "playwright test"\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"suggested-section-names",children:"Suggested Section Names"}),"\n",(0,l.jsx)(n.p,{children:"Adapt to your project. Common sections:"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Section"}),(0,l.jsx)(n.th,{children:"Contents"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Core"}),(0,l.jsx)(n.td,{children:"dev, build, serve, clean, start"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Dev with API"}),(0,l.jsx)(n.td,{children:"Multi-environment dev commands"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Sub-packages"}),(0,l.jsx)(n.td,{children:"Namespace-prefixed sub-app commands"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Code quality"}),(0,l.jsx)(n.td,{children:"typecheck, lint, format, check"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Testing"}),(0,l.jsxs)(n.td,{children:["test, test",":unit",", test",":e2e",", test",":api"]})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Validation & checks"}),(0,l.jsx)(n.td,{children:"404 checkers, link validators"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Deploy"}),(0,l.jsx)(n.td,{children:"deploy scripts"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Data & content tools"}),(0,l.jsx)(n.td,{children:"generators, indexers, content scripts"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Internal & utilities"}),(0,l.jsx)(n.td,{children:"_prefixed helpers, setup scripts"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"external-shell-scripts-for-complex-commands",children:"External Shell Scripts for Complex Commands"}),"\n",(0,l.jsxs)(n.p,{children:["When a npm script needs to start multiple processes or has complex conditional logic, extract to a shell script in ",(0,l.jsx)(n.code,{children:"scripts/"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"when-to-extract",children:"When to Extract"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Command starts 2+ background processes that need coordinated shutdown"}),"\n",(0,l.jsx)(n.li,{children:"Conditional process startup based on env vars"}),"\n",(0,l.jsx)(n.li,{children:"Complex pipe chains or multi-line logic"}),"\n",(0,l.jsx)(n.li,{children:"Same process orchestration reused across multiple npm scripts"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"shell-script-pattern",children:"Shell Script Pattern"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\nset -e\n\ncleanup() {\n  echo ""\n  echo "Shutting down dev servers..."\n  kill $PID_1 2>/dev/null\n  kill $PID_2 2>/dev/null\n  wait $PID_1 2>/dev/null\n  wait $PID_2 2>/dev/null\n  echo "Done."\n}\ntrap cleanup EXIT INT TERM\n\n# Conditionally start a background service\nif [ "$SOME_MODE" = "local" ]; then\n  echo "=== Starting background service ==="\n  some-service --flag &\n  PID_1=$!\n  sleep 3\nfi\n\n# Start main dev server\necho "=== Starting main dev server ==="\npnpm dev &\nPID_2=$!\n\nwait\n'})}),"\n",(0,l.jsx)(n.p,{children:"Key elements:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"set -e"})," \u2014 exit on error"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"trap cleanup EXIT INT TERM"})," \u2014 graceful shutdown on Ctrl+C"]}),"\n",(0,l.jsxs)(n.li,{children:["Background processes with ",(0,l.jsx)(n.code,{children:"&"})," and ",(0,l.jsx)(n.code,{children:"$!"})," to capture PID"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"sleep"})," between process starts if one depends on another"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"wait"})," at the end to keep script alive"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"calling-from-packagejson",children:"Calling from package.json"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "dev:full": "API_MODE=local ./scripts/dev-full.sh",\n  "dev:full:preview": "API_MODE=preview pnpm dev"\n}\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Note: Make scripts executable with ",(0,l.jsx)(n.code,{children:"chmod +x scripts/*.sh"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"multi-environment-dev-commands",children:"Multi-Environment Dev Commands"}),"\n",(0,l.jsx)(n.p,{children:"When your app connects to different API backends (local, preview, production), create a command for each:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "// \u2500\u2500 Dev with API (3 environments) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500": "",\n  "dev:full": "API_MODE=local ./scripts/dev-full.sh",\n  "dev:full:preview": "API_MODE=preview pnpm dev",\n  "dev:full:prod": "API_MODE=production pnpm dev"\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"Pattern:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:":full"})," suffix = starts all required services (multi-process script)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:":preview"})," suffix = points to remote preview API"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:":prod"})," suffix = points to remote production API"]}),"\n",(0,l.jsxs)(n.li,{children:["Base ",(0,l.jsx)(n.code,{children:"dev"})," = no API connection (mock/standalone mode)"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"namespace-prefixed-sub-package-commands",children:"Namespace Prefixed Sub-Package Commands"}),"\n",(0,l.jsx)(n.p,{children:"For monorepos with sub-packages, prefix commands with the package name:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "// \u2500\u2500 my-subapp \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500": "",\n  "my-subapp:dev": "cd sub-packages/my-subapp && pnpm run dev",\n  "my-subapp:dev:full": "SUBAPP_API=local ./scripts/my-subapp-dev-full.sh",\n  "my-subapp:dev:preview": "VITE_API_URL=https://preview.example.com pnpm my-subapp:dev",\n  "my-subapp:dev:prod": "VITE_API_URL=https://example.com pnpm my-subapp:dev",\n  "my-subapp:build": "cd sub-packages/my-subapp && pnpm run build",\n  "my-subapp:test": "pnpm --filter my-subapp test"\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"internalprivate-scripts",children:"Internal/Private Scripts"}),"\n",(0,l.jsxs)(n.p,{children:["Prefix with ",(0,l.jsx)(n.code,{children:"_"})," for scripts not meant to be called directly:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "// \u2500\u2500 Internal & utilities \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500": "",\n  "_prepare": "rm -rf public && mkdir -p public && rsync -a static/ public/",\n  "_kill-port": "lsof -ti:3000 | xargs kill -9 2>/dev/null || true"\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},3351(e,n,s){s.d(n,{R:()=>i,x:()=>c});var t=s(2128);const l={},r=t.createContext(l);function i(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);