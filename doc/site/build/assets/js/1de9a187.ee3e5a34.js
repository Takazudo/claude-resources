"use strict";(self.webpackChunkclaude_code_doc_site=self.webpackChunkclaude_code_doc_site||[]).push([[2407],{3351(e,n,i){i.d(n,{R:()=>r,x:()=>c});var s=i(2128);const l={},t=s.createContext(l);function r(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(t.Provider,{value:n},e.children)}},5955(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"claude/skills/npm-package-develop","title":"npm-package-develop","description":"Develop npm packages with Node.js and TypeScript following modern best practices. Use when: (1) Creating a new npm package from scratch, (2) Setting up package.json exports for dual ESM/CJS, (3) Confi...","source":"@site/docs/claude/skills/npm-package-develop.mdx","sourceDirName":"claude/skills","slug":"/claude/skills/npm-package-develop","permalink":"/docs/claude/skills/npm-package-develop","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":null,"lastUpdatedAt":null,"frontMatter":{"title":"npm-package-develop","description":"Develop npm packages with Node.js and TypeScript following modern best practices. Use when: (1) Creating a new npm package from scratch, (2) Setting up package.json exports for dual ESM/CJS, (3) Confi..."},"sidebar":"claudeSidebar","previous":{"title":"netlify-cli","permalink":"/docs/claude/skills/netlify-cli"},"next":{"title":"npm Package Architecture, Patterns, and Common Gotchas (2025-2026)","permalink":"/docs/claude/skills/npm-package-develop/patterns"}}');var l=i(7900),t=i(3351);const r={title:"npm-package-develop",description:"Develop npm packages with Node.js and TypeScript following modern best practices. Use when: (1) Creating a new npm package from scratch, (2) Setting up package.json exports for dual ESM/CJS, (3) Confi..."},c="npm-package-develop",d={},o=[{value:"Quick Start: Recommended Stack",id:"quick-start-recommended-stack",level:2},{value:"Determine Package Type",id:"determine-package-type",level:2},{value:"Library Setup",id:"library-setup",level:2},{value:"Minimal package.json",id:"minimal-packagejson",level:3},{value:"tsup.config.ts",id:"tsupconfigts",level:3},{value:"tsconfig.json",id:"tsconfigjson",level:3},{value:"File Structure",id:"file-structure",level:3},{value:"CLI Setup",id:"cli-setup",level:2},{value:"package.json (CLI-specific fields)",id:"packagejson-cli-specific-fields",level:3},{value:"Entry file (src/cli.ts)",id:"entry-file-srcclits",level:3},{value:"Key Rules",id:"key-rules",level:2},{value:"exports Field",id:"exports-field",level:3},{value:"files Field",id:"files-field",level:3},{value:"prepublishOnly",id:"prepublishonly",level:3},{value:"sideEffects",id:"sideeffects",level:3},{value:"Tree-Shaking",id:"tree-shaking",level:3},{value:"Pre-Publish Checklist",id:"pre-publish-checklist",level:2},{value:"Detailed References",id:"detailed-references",level:2},{value:"References",id:"references",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"npm-package-develop",children:"npm-package-develop"})}),"\n",(0,l.jsx)(n.admonition,{title:"Bundled Resources",type:"info",children:(0,l.jsxs)(n.p,{children:["This skill includes: ",(0,l.jsx)(n.a,{href:"#references",children:"references"})]})}),"\n",(0,l.jsx)(n.h1,{id:"npm-package-development",children:"npm Package Development"}),"\n",(0,l.jsx)(n.h2,{id:"quick-start-recommended-stack",children:"Quick Start: Recommended Stack"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Build"}),": tsup (esbuild-powered, zero-config, dual CJS/ESM)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Test"}),": vitest (native ESM/TS, Jest-compatible API)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Lint"}),": Biome (all-in-one linter+formatter) or ESLint flat config + Prettier"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Types"}),": TypeScript with ",(0,l.jsx)(n.code,{children:'moduleResolution: "Bundler"'})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Dev"}),": tsx for running TS, tsup --watch for rebuilding"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Publish validation"}),": publint + @arethetypeswrong/cli (attw)"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"determine-package-type",children:"Determine Package Type"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Library package"}),' -> Follow "Library Setup" below']}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"CLI tool package"}),' -> Follow "CLI Setup" below']}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Both"})," -> Combine both patterns"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"library-setup",children:"Library Setup"}),"\n",(0,l.jsx)(n.h3,{id:"minimal-packagejson",children:"Minimal package.json"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "name": "my-library",\n  "version": "0.1.0",\n  "type": "module",\n  "main": "./dist/index.cjs",\n  "module": "./dist/index.js",\n  "types": "./dist/index.d.ts",\n  "exports": {\n    ".": {\n      "import": {\n        "types": "./dist/index.d.ts",\n        "default": "./dist/index.js"\n      },\n      "require": {\n        "types": "./dist/index.d.cts",\n        "default": "./dist/index.cjs"\n      }\n    }\n  },\n  "files": ["dist"],\n  "sideEffects": false,\n  "engines": { "node": ">=18" },\n  "scripts": {\n    "build": "tsup",\n    "dev": "tsup --watch",\n    "test": "vitest",\n    "test:run": "vitest run",\n    "lint": "biome check .",\n    "typecheck": "tsc --noEmit",\n    "prepublishOnly": "npm run build"\n  },\n  "devDependencies": {\n    "@biomejs/biome": "^2.3",\n    "tsup": "^8.4",\n    "typescript": "^5.7",\n    "vitest": "^3.0"\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"tsupconfigts",children:"tsup.config.ts"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'import { defineConfig } from "tsup";\n\nexport default defineConfig({\n  entry: ["src/index.ts"],\n  format: ["cjs", "esm"],\n  dts: true,\n  splitting: false,\n  sourcemap: true,\n  clean: true,\n});\n'})}),"\n",(0,l.jsx)(n.h3,{id:"tsconfigjson",children:"tsconfig.json"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    "target": "ES2022",\n    "module": "ESNext",\n    "moduleResolution": "Bundler",\n    "lib": ["ES2022"],\n    "strict": true,\n    "esModuleInterop": true,\n    "skipLibCheck": true,\n    "forceConsistentCasingInFileNames": true,\n    "verbatimModuleSyntax": true,\n    "isolatedModules": true,\n    "declaration": true,\n    "declarationMap": true,\n    "sourceMap": true,\n    "outDir": "./dist",\n    "rootDir": "./src",\n    "noUncheckedIndexedAccess": true,\n    "noEmit": true\n  },\n  "include": ["src"],\n  "exclude": ["node_modules", "dist"]\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"file-structure",children:"File Structure"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"my-library/\n  src/\n    index.ts\n    index.test.ts\n  package.json\n  tsconfig.json\n  tsup.config.ts\n  vitest.config.ts\n  biome.json\n  .gitignore\n  LICENSE\n  README.md\n"})}),"\n",(0,l.jsx)(n.h2,{id:"cli-setup",children:"CLI Setup"}),"\n",(0,l.jsx)(n.h3,{id:"packagejson-cli-specific-fields",children:"package.json (CLI-specific fields)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "bin": {\n    "my-cli": "./dist/cli.js"\n  },\n  "files": ["dist"]\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"entry-file-srcclits",children:"Entry file (src/cli.ts)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:'#!/usr/bin/env node\nimport { program } from "commander";\n\nprogram\n  .name("my-cli")\n  .version("1.0.0")\n  .description("Description here");\n\nprogram\n  .command("init")\n  .option("-t, --template <name>", "template to use", "default")\n  .action((options) => {\n    console.log(`Template: ${options.template}`);\n  });\n\nprogram.parse();\n'})}),"\n",(0,l.jsxs)(n.p,{children:["CLI argument parsing libraries: ",(0,l.jsx)(n.strong,{children:"commander"})," (most popular, subcommands), ",(0,l.jsx)(n.strong,{children:"yargs"})," (validation, middleware), ",(0,l.jsx)(n.strong,{children:"citty"})," (lightweight ESM-first)."]}),"\n",(0,l.jsx)(n.h2,{id:"key-rules",children:"Key Rules"}),"\n",(0,l.jsx)(n.h3,{id:"exports-field",children:"exports Field"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Always place ",(0,l.jsx)(n.code,{children:"types"})," before ",(0,l.jsx)(n.code,{children:"default"})," within each condition block"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"import"})," condition for ESM, ",(0,l.jsx)(n.code,{children:"require"})," condition for CJS"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"main"}),"/",(0,l.jsx)(n.code,{children:"module"}),"/",(0,l.jsx)(n.code,{children:"types"})," at top level exist for backward compatibility with older tools"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"files-field",children:"files Field"}),"\n",(0,l.jsxs)(n.p,{children:["Always use ",(0,l.jsx)(n.code,{children:"files"})," as a whitelist (not ",(0,l.jsx)(n.code,{children:".npmignore"}),"). Set to ",(0,l.jsx)(n.code,{children:'["dist"]'})," to publish only build output. Verify with ",(0,l.jsx)(n.code,{children:"npm pack --dry-run"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"prepublishonly",children:"prepublishOnly"}),"\n",(0,l.jsxs)(n.p,{children:["Always include a ",(0,l.jsx)(n.code,{children:"prepublishOnly"})," script to build before publishing:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{ "prepublishOnly": "npm run build" }\n'})}),"\n",(0,l.jsx)(n.h3,{id:"sideeffects",children:"sideEffects"}),"\n",(0,l.jsxs)(n.p,{children:["Set ",(0,l.jsx)(n.code,{children:'"sideEffects": false'})," for pure utility libraries to enable tree-shaking. If some files have side effects, list them: ",(0,l.jsx)(n.code,{children:'"sideEffects": ["*.css"]'}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"tree-shaking",children:"Tree-Shaking"}),"\n",(0,l.jsx)(n.p,{children:"Use named exports (not default export of objects). Avoid classes when individual functions suffice."}),"\n",(0,l.jsx)(n.h2,{id:"pre-publish-checklist",children:"Pre-Publish Checklist"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm run build              # Build the package\nnpx publint                # Validate package.json/exports\nnpx attw --pack .          # Validate TypeScript types\nnpm pack --dry-run         # Inspect package contents\nnpm publish --dry-run      # Simulate publish\n"})}),"\n",(0,l.jsx)(n.h2,{id:"detailed-references",children:"Detailed References"}),"\n",(0,l.jsx)(n.p,{children:"Read these when you need specifics:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Build tools, tsconfig, testing, linting, monorepo"}),": ",(0,l.jsx)(n.a,{href:"references/tooling.md",children:"references/tooling.md"})," - tsup/tsdown/unbuild comparison, TypeScript config, vitest setup, Biome vs ESLint, pnpm workspaces + Turborepo, dev workflow"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Publishing, versioning, CI/CD, security"}),": ",(0,l.jsx)(n.a,{href:"references/publishing.md",children:"references/publishing.md"})," - semver, Changesets/semantic-release, GitHub Actions OIDC trusted publishing, npm provenance, publint/attw, size-limit, supply chain security"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Architecture, ESM/CJS, exports, CLI, dependencies"}),": ",(0,l.jsx)(n.a,{href:"references/patterns.md",children:"references/patterns.md"})," - dual publishing patterns, conditional exports, subpath exports, dependency types (peer/optional/bundled), CLI bin setup, argument parsing, tree-shaking optimization"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/claude/skills/npm-package-develop/patterns",children:"npm Package Architecture, Patterns, and Common Gotchas (2025-2026)"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/claude/skills/npm-package-develop/publishing",children:"npm Package Publishing, Versioning, and Quality: Best Practices (2025-2026)"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/claude/skills/npm-package-develop/tooling",children:"npm Package Development Tooling and Project Setup (2025-2026)"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);