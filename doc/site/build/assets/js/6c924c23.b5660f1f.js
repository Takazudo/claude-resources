"use strict";(self.webpackChunkclaude_code_doc_site=self.webpackChunkclaude_code_doc_site||[]).push([[7725],{3351(e,n,s){s.d(n,{R:()=>a,x:()=>t});var l=s(2128);const i={},r=l.createContext(i);function a(e){const n=l.useContext(r);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),l.createElement(r.Provider,{value:n},e.children)}},8880(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"claude/skills/xlsx","title":"xlsx","description":"Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv...","source":"@site/docs/claude/skills/xlsx.mdx","sourceDirName":"claude/skills","slug":"/claude/skills/xlsx","permalink":"/docs/claude/skills/xlsx","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":null,"lastUpdatedAt":null,"frontMatter":{"title":"xlsx","description":"Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv..."},"sidebar":"claudeSidebar","previous":{"title":"watch-ci","permalink":"/docs/claude/skills/watch-ci"},"next":{"title":"zudocg-apply-voice","permalink":"/docs/claude/skills/zudocg-apply-voice"}}');var i=s(7900),r=s(3351);const a={title:"xlsx",description:"Comprehensive spreadsheet creation, editing, and analysis with support for formulas, formatting, data analysis, and visualization. When Claude needs to work with spreadsheets (.xlsx, .xlsm, .csv, .tsv..."},t="xlsx",o={},d=[{value:"All Excel files",id:"all-excel-files",level:2},{value:"Zero Formula Errors",id:"zero-formula-errors",level:3},{value:"Preserve Existing Templates (when updating templates)",id:"preserve-existing-templates-when-updating-templates",level:3},{value:"Financial models",id:"financial-models",level:2},{value:"Color Coding Standards",id:"color-coding-standards",level:3},{value:"Industry-Standard Color Conventions",id:"industry-standard-color-conventions",level:4},{value:"Number Formatting Standards",id:"number-formatting-standards",level:3},{value:"Required Format Rules",id:"required-format-rules",level:4},{value:"Formula Construction Rules",id:"formula-construction-rules",level:3},{value:"Assumptions Placement",id:"assumptions-placement",level:4},{value:"Formula Error Prevention",id:"formula-error-prevention",level:4},{value:"Documentation Requirements for Hardcodes",id:"documentation-requirements-for-hardcodes",level:4},{value:"Overview",id:"overview",level:2},{value:"Important Requirements",id:"important-requirements",level:2},{value:"Reading and analyzing data",id:"reading-and-analyzing-data",level:2},{value:"Data analysis with pandas",id:"data-analysis-with-pandas",level:3},{value:"Excel File Workflows",id:"excel-file-workflows",level:2},{value:"CRITICAL: Use Formulas, Not Hardcoded Values",id:"critical-use-formulas-not-hardcoded-values",level:2},{value:"\u274c WRONG - Hardcoding Calculated Values",id:"-wrong---hardcoding-calculated-values",level:3},{value:"\u2705 CORRECT - Using Excel Formulas",id:"-correct---using-excel-formulas",level:3},{value:"Common Workflow",id:"common-workflow",level:2},{value:"Creating new Excel files",id:"creating-new-excel-files",level:3},{value:"Editing existing Excel files",id:"editing-existing-excel-files",level:3},{value:"Recalculating formulas",id:"recalculating-formulas",level:2},{value:"Formula Verification Checklist",id:"formula-verification-checklist",level:2},{value:"Essential Verification",id:"essential-verification",level:3},{value:"Common Pitfalls",id:"common-pitfalls",level:3},{value:"Formula Testing Strategy",id:"formula-testing-strategy",level:3},{value:"Interpreting recalc.py Output",id:"interpreting-recalcpy-output",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Library Selection",id:"library-selection",level:3},{value:"Working with openpyxl",id:"working-with-openpyxl",level:3},{value:"Working with pandas",id:"working-with-pandas",level:3},{value:"Code Style Guidelines",id:"code-style-guidelines",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"xlsx",children:"xlsx"})}),"\n",(0,i.jsx)(n.h1,{id:"requirements-for-outputs",children:"Requirements for Outputs"}),"\n",(0,i.jsx)(n.h2,{id:"all-excel-files",children:"All Excel files"}),"\n",(0,i.jsx)(n.h3,{id:"zero-formula-errors",children:"Zero Formula Errors"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Every Excel model MUST be delivered with ZERO formula errors (#REF!, #DIV/0!, #VALUE!, #N/A, #NAME?)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"preserve-existing-templates-when-updating-templates",children:"Preserve Existing Templates (when updating templates)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Study and EXACTLY match existing format, style, and conventions when modifying files"}),"\n",(0,i.jsx)(n.li,{children:"Never impose standardized formatting on files with established patterns"}),"\n",(0,i.jsx)(n.li,{children:"Existing template conventions ALWAYS override these guidelines"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"financial-models",children:"Financial models"}),"\n",(0,i.jsx)(n.h3,{id:"color-coding-standards",children:"Color Coding Standards"}),"\n",(0,i.jsx)(n.p,{children:"Unless otherwise stated by the user or existing template"}),"\n",(0,i.jsx)(n.h4,{id:"industry-standard-color-conventions",children:"Industry-Standard Color Conventions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Blue text (RGB: 0,0,255)"}),": Hardcoded inputs, and numbers users will change for scenarios"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Black text (RGB: 0,0,0)"}),": ALL formulas and calculations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Green text (RGB: 0,128,0)"}),": Links pulling from other worksheets within same workbook"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Red text (RGB: 255,0,0)"}),": External links to other files"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Yellow background (RGB: 255,255,0)"}),": Key assumptions needing attention or cells that need to be updated"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"number-formatting-standards",children:"Number Formatting Standards"}),"\n",(0,i.jsx)(n.h4,{id:"required-format-rules",children:"Required Format Rules"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Years"}),': Format as text strings (e.g., "2024" not "2,024")']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Currency"}),': Use $#,##0 format; ALWAYS specify units in headers ("Revenue ($mm)")']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Zeros"}),': Use number formatting to make all zeros "-", including percentages (e.g., "$#,##0;($#,##0);-")']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Percentages"}),": Default to 0.0% format (one decimal)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Multiples"}),": Format as 0.0x for valuation multiples (EV/EBITDA, P/E)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Negative numbers"}),": Use parentheses (123) not minus -123"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"formula-construction-rules",children:"Formula Construction Rules"}),"\n",(0,i.jsx)(n.h4,{id:"assumptions-placement",children:"Assumptions Placement"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Place ALL assumptions (growth rates, margins, multiples, etc.) in separate assumption cells"}),"\n",(0,i.jsx)(n.li,{children:"Use cell references instead of hardcoded values in formulas"}),"\n",(0,i.jsx)(n.li,{children:"Example: Use =B5*(1+$B$6) instead of =B5*1.05"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"formula-error-prevention",children:"Formula Error Prevention"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verify all cell references are correct"}),"\n",(0,i.jsx)(n.li,{children:"Check for off-by-one errors in ranges"}),"\n",(0,i.jsx)(n.li,{children:"Ensure consistent formulas across all projection periods"}),"\n",(0,i.jsx)(n.li,{children:"Test with edge cases (zero values, negative numbers)"}),"\n",(0,i.jsx)(n.li,{children:"Verify no unintended circular references"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"documentation-requirements-for-hardcodes",children:"Documentation Requirements for Hardcodes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'Comment or in cells beside (if end of table). Format: "Source: [System/Document], [Date], [Specific Reference], [URL if applicable]"'}),"\n",(0,i.jsxs)(n.li,{children:["Examples:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'"Source: Company 10-K, FY2024, Page 45, Revenue Note, [SEC EDGAR URL]"'}),"\n",(0,i.jsx)(n.li,{children:'"Source: Company 10-Q, Q2 2025, Exhibit 99.1, [SEC EDGAR URL]"'}),"\n",(0,i.jsx)(n.li,{children:'"Source: Bloomberg Terminal, 8/15/2025, AAPL US Equity"'}),"\n",(0,i.jsx)(n.li,{children:'"Source: FactSet, 8/20/2025, Consensus Estimates Screen"'}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"xlsx-creation-editing-and-analysis",children:"XLSX creation, editing, and analysis"}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"A user may ask you to create, edit, or analyze the contents of an .xlsx file. You have different tools and workflows available for different tasks."}),"\n",(0,i.jsx)(n.h2,{id:"important-requirements",children:"Important Requirements"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"LibreOffice Required for Formula Recalculation"}),": You can assume LibreOffice is installed for recalculating formula values using the ",(0,i.jsx)(n.code,{children:"recalc.py"})," script. The script automatically configures LibreOffice on first run"]}),"\n",(0,i.jsx)(n.h2,{id:"reading-and-analyzing-data",children:"Reading and analyzing data"}),"\n",(0,i.jsx)(n.h3,{id:"data-analysis-with-pandas",children:"Data analysis with pandas"}),"\n",(0,i.jsxs)(n.p,{children:["For data analysis, visualization, and basic operations, use ",(0,i.jsx)(n.strong,{children:"pandas"})," which provides powerful data manipulation capabilities:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import pandas as pd\n\n# Read Excel\ndf = pd.read_excel('file.xlsx')  # Default: first sheet\nall_sheets = pd.read_excel('file.xlsx', sheet_name=None)  # All sheets as dict\n\n# Analyze\ndf.head()      # Preview data\ndf.info()      # Column info\ndf.describe()  # Statistics\n\n# Write Excel\ndf.to_excel('output.xlsx', index=False)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"excel-file-workflows",children:"Excel File Workflows"}),"\n",(0,i.jsx)(n.h2,{id:"critical-use-formulas-not-hardcoded-values",children:"CRITICAL: Use Formulas, Not Hardcoded Values"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Always use Excel formulas instead of calculating values in Python and hardcoding them."})," This ensures the spreadsheet remains dynamic and updateable."]}),"\n",(0,i.jsx)(n.h3,{id:"-wrong---hardcoding-calculated-values",children:"\u274c WRONG - Hardcoding Calculated Values"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Bad: Calculating in Python and hardcoding result\ntotal = df['Sales'].sum()\nsheet['B10'] = total  # Hardcodes 5000\n\n# Bad: Computing growth rate in Python\ngrowth = (df.iloc[-1]['Revenue'] - df.iloc[0]['Revenue']) / df.iloc[0]['Revenue']\nsheet['C5'] = growth  # Hardcodes 0.15\n\n# Bad: Python calculation for average\navg = sum(values) / len(values)\nsheet['D20'] = avg  # Hardcodes 42.5\n"})}),"\n",(0,i.jsx)(n.h3,{id:"-correct---using-excel-formulas",children:"\u2705 CORRECT - Using Excel Formulas"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Good: Let Excel calculate the sum\nsheet['B10'] = '=SUM(B2:B9)'\n\n# Good: Growth rate as Excel formula\nsheet['C5'] = '=(C4-C2)/C2'\n\n# Good: Average using Excel function\nsheet['D20'] = '=AVERAGE(D2:D19)'\n"})}),"\n",(0,i.jsx)(n.p,{children:"This applies to ALL calculations - totals, percentages, ratios, differences, etc. The spreadsheet should be able to recalculate when source data changes."}),"\n",(0,i.jsx)(n.h2,{id:"common-workflow",children:"Common Workflow"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Choose tool"}),": pandas for data, openpyxl for formulas/formatting"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create/Load"}),": Create new workbook or load existing file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Modify"}),": Add/edit data, formulas, and formatting"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Save"}),": Write to file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Recalculate formulas (MANDATORY IF USING FORMULAS)"}),": Use the recalc.py script","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"python recalc.py output.xlsx\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Verify and fix any errors"}),":","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The script returns JSON with error details"}),"\n",(0,i.jsxs)(n.li,{children:["If ",(0,i.jsx)(n.code,{children:"status"})," is ",(0,i.jsx)(n.code,{children:"errors_found"}),", check ",(0,i.jsx)(n.code,{children:"error_summary"})," for specific error types and locations"]}),"\n",(0,i.jsx)(n.li,{children:"Fix the identified errors and recalculate again"}),"\n",(0,i.jsxs)(n.li,{children:["Common errors to fix:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"#REF!"}),": Invalid cell references"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"#DIV/0!"}),": Division by zero"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"#VALUE!"}),": Wrong data type in formula"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"#NAME?"}),": Unrecognized formula name"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"creating-new-excel-files",children:"Creating new Excel files"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Using openpyxl for formulas and formatting\nfrom openpyxl import Workbook\nfrom openpyxl.styles import Font, PatternFill, Alignment\n\nwb = Workbook()\nsheet = wb.active\n\n# Add data\nsheet['A1'] = 'Hello'\nsheet['B1'] = 'World'\nsheet.append(['Row', 'of', 'data'])\n\n# Add formula\nsheet['B2'] = '=SUM(A1:A10)'\n\n# Formatting\nsheet['A1'].font = Font(bold=True, color='FF0000')\nsheet['A1'].fill = PatternFill('solid', start_color='FFFF00')\nsheet['A1'].alignment = Alignment(horizontal='center')\n\n# Column width\nsheet.column_dimensions['A'].width = 20\n\nwb.save('output.xlsx')\n"})}),"\n",(0,i.jsx)(n.h3,{id:"editing-existing-excel-files",children:"Editing existing Excel files"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Using openpyxl to preserve formulas and formatting\nfrom openpyxl import load_workbook\n\n# Load existing file\nwb = load_workbook('existing.xlsx')\nsheet = wb.active  # or wb['SheetName'] for specific sheet\n\n# Working with multiple sheets\nfor sheet_name in wb.sheetnames:\n    sheet = wb[sheet_name]\n    print(f\"Sheet: {sheet_name}\")\n\n# Modify cells\nsheet['A1'] = 'New Value'\nsheet.insert_rows(2)  # Insert row at position 2\nsheet.delete_cols(3)  # Delete column 3\n\n# Add new sheet\nnew_sheet = wb.create_sheet('NewSheet')\nnew_sheet['A1'] = 'Data'\n\nwb.save('modified.xlsx')\n"})}),"\n",(0,i.jsx)(n.h2,{id:"recalculating-formulas",children:"Recalculating formulas"}),"\n",(0,i.jsxs)(n.p,{children:["Excel files created or modified by openpyxl contain formulas as strings but not calculated values. Use the provided ",(0,i.jsx)(n.code,{children:"recalc.py"})," script to recalculate formulas:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"python recalc.py <excel_file> [timeout_seconds]\n"})}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"python recalc.py output.xlsx 30\n"})}),"\n",(0,i.jsx)(n.p,{children:"The script:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Automatically sets up LibreOffice macro on first run"}),"\n",(0,i.jsx)(n.li,{children:"Recalculates all formulas in all sheets"}),"\n",(0,i.jsx)(n.li,{children:"Scans ALL cells for Excel errors (#REF!, #DIV/0!, etc.)"}),"\n",(0,i.jsx)(n.li,{children:"Returns JSON with detailed error locations and counts"}),"\n",(0,i.jsx)(n.li,{children:"Works on both Linux and macOS"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"formula-verification-checklist",children:"Formula Verification Checklist"}),"\n",(0,i.jsx)(n.p,{children:"Quick checks to ensure formulas work correctly:"}),"\n",(0,i.jsx)(n.h3,{id:"essential-verification",children:"Essential Verification"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Test 2-3 sample references"}),": Verify they pull correct values before building full model"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Column mapping"}),": Confirm Excel columns match (e.g., column 64 = BL, not BK)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Row offset"}),": Remember Excel rows are 1-indexed (DataFrame row 5 = Excel row 6)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"common-pitfalls",children:"Common Pitfalls"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"NaN handling"}),": Check for null values with ",(0,i.jsx)(n.code,{children:"pd.notna()"})]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Far-right columns"}),": FY data often in columns 50+"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Multiple matches"}),": Search all occurrences, not just first"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Division by zero"}),": Check denominators before using ",(0,i.jsx)(n.code,{children:"/"})," in formulas (#DIV/0!)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Wrong references"}),": Verify all cell references point to intended cells (#REF!)"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Cross-sheet references"}),": Use correct format (Sheet1!A1) for linking sheets"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"formula-testing-strategy",children:"Formula Testing Strategy"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Start small"}),": Test formulas on 2-3 cells before applying broadly"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Verify dependencies"}),": Check all cells referenced in formulas exist"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ",(0,i.jsx)(n.strong,{children:"Test edge cases"}),": Include zero, negative, and very large values"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"interpreting-recalcpy-output",children:"Interpreting recalc.py Output"}),"\n",(0,i.jsx)(n.p,{children:"The script returns JSON with error details:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "status": "success",           // or "errors_found"\n  "total_errors": 0,              // Total error count\n  "total_formulas": 42,           // Number of formulas in file\n  "error_summary": {              // Only present if errors found\n    "#REF!": {\n      "count": 2,\n      "locations": ["Sheet1!B5", "Sheet1!C10"]\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsx)(n.h3,{id:"library-selection",children:"Library Selection"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"pandas"}),": Best for data analysis, bulk operations, and simple data export"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"openpyxl"}),": Best for complex formatting, formulas, and Excel-specific features"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"working-with-openpyxl",children:"Working with openpyxl"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Cell indices are 1-based (row=1, column=1 refers to cell A1)"}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"data_only=True"})," to read calculated values: ",(0,i.jsx)(n.code,{children:"load_workbook('file.xlsx', data_only=True)"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Warning"}),": If opened with ",(0,i.jsx)(n.code,{children:"data_only=True"})," and saved, formulas are replaced with values and permanently lost"]}),"\n",(0,i.jsxs)(n.li,{children:["For large files: Use ",(0,i.jsx)(n.code,{children:"read_only=True"})," for reading or ",(0,i.jsx)(n.code,{children:"write_only=True"})," for writing"]}),"\n",(0,i.jsx)(n.li,{children:"Formulas are preserved but not evaluated - use recalc.py to update values"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"working-with-pandas",children:"Working with pandas"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Specify data types to avoid inference issues: ",(0,i.jsx)(n.code,{children:"pd.read_excel('file.xlsx', dtype={'id': str})"})]}),"\n",(0,i.jsxs)(n.li,{children:["For large files, read specific columns: ",(0,i.jsx)(n.code,{children:"pd.read_excel('file.xlsx', usecols=['A', 'C', 'E'])"})]}),"\n",(0,i.jsxs)(n.li,{children:["Handle dates properly: ",(0,i.jsx)(n.code,{children:"pd.read_excel('file.xlsx', parse_dates=['date_column'])"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"code-style-guidelines",children:"Code Style Guidelines"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"IMPORTANT"}),": When generating Python code for Excel operations:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Write minimal, concise Python code without unnecessary comments"}),"\n",(0,i.jsx)(n.li,{children:"Avoid verbose variable names and redundant operations"}),"\n",(0,i.jsx)(n.li,{children:"Avoid unnecessary print statements"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"For Excel files themselves"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add comments to cells with complex formulas or important assumptions"}),"\n",(0,i.jsx)(n.li,{children:"Document data sources for hardcoded values"}),"\n",(0,i.jsx)(n.li,{children:"Include notes for key calculations and model sections"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);