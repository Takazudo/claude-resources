"use strict";(self.webpackChunkclaude_code_doc_site=self.webpackChunkclaude_code_doc_site||[]).push([[134],{2568(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"claude/skills/netlify-cli","title":"netlify-cli","description":"Use this skill when writing or debugging GitHub Actions workflows that deploy to Netlify using `netlify-cli`, or when running `netlify dev` / `netlify functions:serve` locally. This skill contains cri...","source":"@site/docs/claude/skills/netlify-cli.mdx","sourceDirName":"claude/skills","slug":"/claude/skills/netlify-cli","permalink":"/docs/claude/skills/netlify-cli","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedBy":null,"lastUpdatedAt":null,"frontMatter":{"title":"netlify-cli","description":"Use this skill when writing or debugging GitHub Actions workflows that deploy to Netlify using `netlify-cli`, or when running `netlify dev` / `netlify functions:serve` locally. This skill contains cri..."},"sidebar":"claudeSidebar","previous":{"title":"Mermaid Syntax Guide","permalink":"/docs/claude/skills/mermaid-generator/syntax-guide"},"next":{"title":"npm-package-develop","permalink":"/docs/claude/skills/npm-package-develop"}}');var l=i(7900),r=i(3351);const o={title:"netlify-cli",description:"Use this skill when writing or debugging GitHub Actions workflows that deploy to Netlify using `netlify-cli`, or when running `netlify dev` / `netlify functions:serve` locally. This skill contains cri..."},s="netlify-cli",d={},c=[{value:"Key Flags Reference",id:"key-flags-reference",level:2},{value:"Critical: Monorepo &quot;Projects Detected&quot; Error",id:"critical-monorepo-projects-detected-error",level:2},{value:"Solution",id:"solution",level:3},{value:"Critical: netlify.toml Inheritance Problem",id:"critical-netlifytoml-inheritance-problem",level:2},{value:"Solution: Deploy from an Isolated Directory",id:"solution-deploy-from-an-isolated-directory",level:3},{value:"Critical: basePath / baseUrl Wrapping for Proxied Deploys",id:"critical-basepath--baseurl-wrapping-for-proxied-deploys",level:2},{value:"Standard Single-Project Deploy",id:"standard-single-project-deploy",level:2},{value:"Capturing Deploy URL",id:"capturing-deploy-url",level:2},{value:"Without --json (simpler, recommended)",id:"without---json-simpler-recommended",level:3},{value:"With --json (for more data)",id:"with---json-for-more-data",level:3},{value:"Complete GitHub Action Example (Monorepo Sub-Site)",id:"complete-github-action-example-monorepo-sub-site",level:2},{value:"Common Errors and Solutions",id:"common-errors-and-solutions",level:2},{value:"Error: &quot;Projects detected&quot;",id:"error-projects-detected",level:3},{value:"Error: &quot;Projects detected&quot; with <code>netlify link</code>",id:"error-projects-detected-with-netlify-link",level:3},{value:"Error: &quot;unknown option &#39;--no-build&#39;&quot;",id:"error-unknown-option---no-build",level:3},{value:"Error: &quot;Could not resolve @netlify/blobs&quot; (or other function bundling errors)",id:"error-could-not-resolve-netlifyblobs-or-other-function-bundling-errors",level:3},{value:"Error: Circular redirect / 404 on branch deploy",id:"error-circular-redirect--404-on-branch-deploy",level:3},{value:"Error: &quot;Build directory not found&quot;",id:"error-build-directory-not-found",level:3},{value:"Error: &quot;Invalid character in header&quot;",id:"error-invalid-character-in-header",level:3},{value:"Setup Requirements",id:"setup-requirements",level:2},{value:"GitHub Secrets Needed",id:"github-secrets-needed",level:3},{value:"Disable Netlify Auto-Build",id:"disable-netlify-auto-build",level:3},{value:"Using nwtgck/actions-netlify Instead",id:"using-nwtgckactions-netlify-instead",level:2},{value:"Local Development with <code>netlify dev</code>",id:"local-development-with-netlify-dev",level:2},{value:"Basic Usage (Monorepo)",id:"basic-usage-monorepo",level:3},{value:"What <code>netlify dev</code> Does",id:"what-netlify-dev-does",level:3},{value:"pnpm 10.x Trust Store Error with <code>dlx</code>",id:"pnpm-10x-trust-store-error-with-dlx",level:3},{value:"<code>netlify dev</code> Crash Workaround",id:"netlify-dev-crash-workaround",level:3},{value:"<code>netlify functions:serve</code> vs <code>netlify dev</code>",id:"netlify-functionsserve-vs-netlify-dev",level:3}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"netlify-cli",children:"netlify-cli"})}),"\n",(0,l.jsx)(n.h1,{id:"netlify-cli-for-github-actions",children:"Netlify CLI for GitHub Actions"}),"\n",(0,l.jsxs)(n.p,{children:["Use this skill when writing or debugging GitHub Actions workflows that deploy to Netlify using ",(0,l.jsx)(n.code,{children:"netlify-cli"}),". This skill contains critical knowledge about common pitfalls and solutions."]}),"\n",(0,l.jsx)(n.h2,{id:"key-flags-reference",children:"Key Flags Reference"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"netlify deploy \\\n  --dir=<path>           # Directory to deploy (required)\n  --site=<site-id>       # Netlify site ID\n  --auth=<token>         # Auth token (or use NETLIFY_AUTH_TOKEN env var)\n  --prod                 # Deploy to production (default: draft)\n  --build                # Opt-in to running build before deploy (deploy does NOT build by default)\n  --filter=<package>     # Select package in monorepo - CRITICAL for pnpm workspaces\n  --functions=<folder>   # Override functions directory (useful to skip functions with empty dir)\n  --alias=<name>         # Custom subdomain for draft deploys\n  --message=<msg>        # Deployment message\n  --json                 # Output as JSON (for programmatic URL extraction)\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"IMPORTANT"}),": There is NO ",(0,l.jsx)(n.code,{children:"--no-build"})," flag in netlify-cli@19+. ",(0,l.jsx)(n.code,{children:"netlify deploy"})," does NOT build by default. Use ",(0,l.jsx)(n.code,{children:"--build"})," only if you want to opt-in to building."]}),"\n",(0,l.jsx)(n.h2,{id:"critical-monorepo-projects-detected-error",children:'Critical: Monorepo "Projects Detected" Error'}),"\n",(0,l.jsxs)(n.p,{children:["When deploying from a ",(0,l.jsx)(n.strong,{children:"pnpm workspace"})," or ",(0,l.jsx)(n.strong,{children:"monorepo"}),", you will encounter:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Error: Projects detected: package-a, package-b. Configure the project you want to work with and try again.\n"})}),"\n",(0,l.jsx)(n.h3,{id:"solution",children:"Solution"}),"\n",(0,l.jsxs)(n.p,{children:["Use the ",(0,l.jsx)(n.code,{children:"--filter"})," flag to select the target package:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"netlify deploy \\\n  --dir=./doc/build \\\n  --site=$NETLIFY_SITE_ID \\\n  --auth=$NETLIFY_AUTH_TOKEN \\\n  --filter=<package-name> \\\n  --prod\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"--filter=&lt;package-name&gt;"}),": Selects the package (use the ",(0,l.jsx)(n.code,{children:"name"})," from package.json)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"netlify deploy"})," does NOT build by default, so no extra flag is needed to skip building"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"critical-netlifytoml-inheritance-problem",children:"Critical: netlify.toml Inheritance Problem"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsxs)(n.strong,{children:["The CLI always reads ",(0,l.jsx)(n.code,{children:"netlify.toml"})," from the project root"]}),", regardless of the ",(0,l.jsx)(n.code,{children:"--dir"})," flag. This means:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Redirects"})," defined in the root ",(0,l.jsx)(n.code,{children:"netlify.toml"})," apply to ALL deploys (including branch/alias deploys)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Functions"})," from the root config are bundled into every deploy"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Circular proxy"}),": If root ",(0,l.jsx)(n.code,{children:"netlify.toml"})," has a redirect like ",(0,l.jsx)(n.code,{children:"/doc/* -> https://doc--mysite.netlify.app/doc/:splat"})," with ",(0,l.jsx)(n.code,{children:"force = true"}),", the branch deploy will proxy to itself, causing 404s"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"solution-deploy-from-an-isolated-directory",children:"Solution: Deploy from an Isolated Directory"}),"\n",(0,l.jsxs)(n.p,{children:["To prevent the root ",(0,l.jsx)(n.code,{children:"netlify.toml"})," from affecting a sub-site deploy, deploy from a separate directory with its own minimal ",(0,l.jsx)(n.code,{children:"netlify.toml"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'- name: Prepare deploy directory\n  run: |\n    mkdir -p deploy-output/doc\n    cp -r doc/build/* deploy-output/doc/\n    mkdir -p deploy-output/.empty-functions\n    cat > deploy-output/netlify.toml << \'TOML\'\n    [build]\n      publish = "."\n    TOML\n\n- name: Deploy to Netlify\n  working-directory: deploy-output\n  env:\n    NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}\n    NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}\n  run: |\n    netlify deploy \\\n      --dir=. \\\n      --functions=.empty-functions \\\n      --site=$NETLIFY_SITE_ID \\\n      --auth=$NETLIFY_AUTH_TOKEN \\\n      --alias=doc \\\n      --message="Deploy: ${{ github.sha }}"\n'})}),"\n",(0,l.jsx)(n.p,{children:"Key points:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"working-directory: deploy-output"})," makes the CLI find the local ",(0,l.jsx)(n.code,{children:"netlify.toml"})," instead of the root one"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"--functions=.empty-functions"})," overrides the root's functions directory to avoid bundling errors"]}),"\n",(0,l.jsxs)(n.li,{children:["The local ",(0,l.jsx)(n.code,{children:"netlify.toml"})," has no redirects, so no circular proxy issues"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"--filter"})," is not needed when deploying from an isolated directory (no monorepo detection)"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"critical-basepath--baseurl-wrapping-for-proxied-deploys",children:"Critical: basePath / baseUrl Wrapping for Proxied Deploys"}),"\n",(0,l.jsxs)(n.p,{children:["When a sub-site is proxied from the main site under a path prefix (e.g., ",(0,l.jsx)(n.code,{children:"mysite.com/doc/"})," -> ",(0,l.jsx)(n.code,{children:"doc--mysite.netlify.app/doc/"}),"), the build output must be nested in a matching subdirectory."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Problem"}),": ",(0,l.jsx)(n.code,{children:"netlify deploy --dir=doc/build"})," deploys files at root ",(0,l.jsx)(n.code,{children:"/"}),". But if the framework (e.g., Docusaurus with ",(0,l.jsx)(n.code,{children:"baseUrl: '/doc/'"}),") generates asset references like ",(0,l.jsx)(n.code,{children:"/doc/assets/main.js"}),", they will 404 because the actual file is at ",(0,l.jsx)(n.code,{children:"/assets/main.js"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Wrap the build output in the correct subdirectory before deploying:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"- name: Prepare deploy directory\n  run: |\n    mkdir -p deploy-output/doc\n    cp -r doc/build/* deploy-output/doc/\n\n- name: Deploy\n  run: netlify deploy --dir=deploy-output ...\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Now ",(0,l.jsx)(n.code,{children:"doc--mysite.netlify.app/doc/assets/main.js"})," resolves correctly."]}),"\n",(0,l.jsx)(n.h2,{id:"standard-single-project-deploy",children:"Standard Single-Project Deploy"}),"\n",(0,l.jsx)(n.p,{children:"For non-monorepo projects:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'- name: Install Netlify CLI\n  run: npm install -g netlify-cli\n\n- name: Deploy to Netlify\n  run: |\n    netlify deploy \\\n      --dir=./out \\\n      --site=${{ secrets.NETLIFY_SITE_ID }} \\\n      --auth=${{ secrets.NETLIFY_AUTH_TOKEN }} \\\n      --prod \\\n      --message="Deploy from GitHub Actions - ${{ github.sha }}"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"capturing-deploy-url",children:"Capturing Deploy URL"}),"\n",(0,l.jsx)(n.h3,{id:"without---json-simpler-recommended",children:"Without --json (simpler, recommended)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'- name: Deploy to Netlify\n  id: deploy\n  run: |\n    OUTPUT=$(netlify deploy \\\n      --dir=./build \\\n      --site=${{ secrets.NETLIFY_SITE_ID }} \\\n      --auth=${{ secrets.NETLIFY_AUTH_TOKEN }} \\\n      --prod \\\n      --message="Deploy: ${{ github.sha }}" 2>&1)\n\n    echo "$OUTPUT"\n\n    DEPLOY_URL=$(echo "$OUTPUT" | grep -o \'https://[^ ]*netlify.app\' | head -1)\n    echo "deploy-url=$DEPLOY_URL" >> $GITHUB_OUTPUT\n'})}),"\n",(0,l.jsx)(n.h3,{id:"with---json-for-more-data",children:"With --json (for more data)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'- name: Deploy to Netlify\n  id: deploy\n  run: |\n    OUTPUT=$(netlify deploy \\\n      --dir=./build \\\n      --site=${{ secrets.NETLIFY_SITE_ID }} \\\n      --auth=${{ secrets.NETLIFY_AUTH_TOKEN }} \\\n      --prod \\\n      --json)\n\n    DEPLOY_URL=$(echo "$OUTPUT" | jq -r \'.deploy_url\')\n    echo "deploy-url=$DEPLOY_URL" >> $GITHUB_OUTPUT\n'})}),"\n",(0,l.jsx)(n.h2,{id:"complete-github-action-example-monorepo-sub-site",children:"Complete GitHub Action Example (Monorepo Sub-Site)"}),"\n",(0,l.jsx)(n.p,{children:"Deploys a Docusaurus sub-site from a monorepo as a branch deploy, isolated from the main site's config:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"name: Deploy Documentation\n\non:\n  push:\n    branches: [doc]\n\nconcurrency:\n  group: doc-deploy\n  cancel-in-progress: true\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    timeout-minutes: 15\n    steps:\n      - uses: actions/checkout@v4\n\n      - uses: pnpm/action-setup@v4\n        with:\n          version: 10\n\n      - uses: actions/setup-node@v4\n        with:\n          node-version: '20'\n\n      - name: Install documentation dependencies\n        working-directory: doc\n        run: pnpm install --frozen-lockfile\n\n      - name: Build Docusaurus documentation\n        working-directory: doc\n        run: pnpm run build\n\n      - name: Install Netlify CLI\n        run: npm install -g netlify-cli@19\n\n      - name: Prepare deploy directory\n        run: |\n          mkdir -p deploy-output/doc\n          cp -r doc/build/* deploy-output/doc/\n          mkdir -p deploy-output/.empty-functions\n          cat > deploy-output/netlify.toml << 'TOML'\n          [build]\n            publish = \".\"\n          TOML\n\n      - name: Deploy to Netlify (branch deploy)\n        working-directory: deploy-output\n        env:\n          NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}\n          NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}\n        run: |\n          netlify deploy \\\n            --dir=. \\\n            --functions=.empty-functions \\\n            --site=$NETLIFY_SITE_ID \\\n            --auth=$NETLIFY_AUTH_TOKEN \\\n            --alias=doc \\\n            --message=\"Documentation deploy: ${{ github.sha }}\"\n"})}),"\n",(0,l.jsx)(n.h2,{id:"common-errors-and-solutions",children:"Common Errors and Solutions"}),"\n",(0,l.jsx)(n.h3,{id:"error-projects-detected",children:'Error: "Projects detected"'}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cause"}),": Monorepo with multiple package.json files"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Add ",(0,l.jsx)(n.code,{children:"--filter=&lt;package-name&gt;"})," flag to ",(0,l.jsx)(n.code,{children:"netlify deploy"})]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"error-projects-detected-with-netlify-link",children:['Error: "Projects detected" with ',(0,l.jsx)(n.code,{children:"netlify link"})]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cause"}),": ",(0,l.jsx)(n.code,{children:"netlify link"})," does NOT support ",(0,l.jsx)(n.code,{children:"--filter"})," flag and fails in monorepos"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": ",(0,l.jsxs)(n.strong,{children:["Don't use ",(0,l.jsx)(n.code,{children:"netlify link"})]})," in monorepos. It's unnecessary when using ",(0,l.jsx)(n.code,{children:"--site"})," flag with ",(0,l.jsx)(n.code,{children:"netlify deploy"}),". The ",(0,l.jsx)(n.code,{children:"--site"})," flag directly specifies the target site, making explicit linking redundant."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"error-unknown-option---no-build",children:"Error: \"unknown option '--no-build'\""}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cause"}),": ",(0,l.jsx)(n.code,{children:"--no-build"})," does not exist in netlify-cli@19+"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Remove the flag. ",(0,l.jsx)(n.code,{children:"netlify deploy"})," does NOT build by default. Use ",(0,l.jsx)(n.code,{children:"--build"})," only when you want to opt-in to building."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"error-could-not-resolve-netlifyblobs-or-other-function-bundling-errors",children:'Error: "Could not resolve @netlify/blobs" (or other function bundling errors)'}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cause"}),": The CLI picks up functions from the root ",(0,l.jsx)(n.code,{children:"netlify.toml"})," config, even when deploying a sub-site that doesn't need functions"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Use ",(0,l.jsx)(n.code,{children:"--functions=&lt;empty-dir&gt;"})," to override. Create an empty directory and point to it:","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"mkdir -p .empty-functions\nnetlify deploy --functions=.empty-functions ...\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"error-circular-redirect--404-on-branch-deploy",children:"Error: Circular redirect / 404 on branch deploy"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cause"}),": Root ",(0,l.jsx)(n.code,{children:"netlify.toml"})," has a redirect like ",(0,l.jsx)(n.code,{children:"/doc/* -> https://doc--mysite.netlify.app/doc/:splat"})," with ",(0,l.jsx)(n.code,{children:"force = true"}),". On the branch deploy itself, this redirect proxies to itself."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Deploy from an isolated directory with its own ",(0,l.jsx)(n.code,{children:"netlify.toml"})," that has no redirects. Use ",(0,l.jsx)(n.code,{children:"working-directory"})," in the GitHub Actions step so the CLI finds the local config instead of the root one."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"error-build-directory-not-found",children:'Error: "Build directory not found"'}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cause"}),": Wrong ",(0,l.jsx)(n.code,{children:"--dir"})," path or build artifacts not downloaded"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Verify path and ensure artifacts are downloaded in CI"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"error-invalid-character-in-header",children:'Error: "Invalid character in header"'}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Cause"}),": Whitespace in auth token"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Solution"}),": Trim the token: ",(0,l.jsx)(n.code,{children:"export NETLIFY_AUTH_TOKEN=$(echo \"$TOKEN\" | tr -d '[:space:]')"})]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"setup-requirements",children:"Setup Requirements"}),"\n",(0,l.jsx)(n.h3,{id:"github-secrets-needed",children:"GitHub Secrets Needed"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"NETLIFY_SITE_ID"})," - From Site settings -> General -> Site details -> API ID"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"NETLIFY_AUTH_TOKEN"})," - From User settings -> Applications -> Personal access tokens"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"disable-netlify-auto-build",children:"Disable Netlify Auto-Build"}),"\n",(0,l.jsx)(n.p,{children:"When using GitHub Actions for deployment, disable Netlify's built-in CI:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Go to Site Settings -> Build & deploy"}),"\n",(0,l.jsxs)(n.li,{children:["Set Build command to empty or ",(0,l.jsx)(n.code,{children:'echo "Disabled"'})]}),"\n",(0,l.jsxs)(n.li,{children:["Or create ",(0,l.jsx)(n.code,{children:"netlify.toml"}),":"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[build]\n  command = "echo \'Build disabled - deploying from GitHub Actions\'"\n  publish = "out"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"using-nwtgckactions-netlify-instead",children:"Using nwtgck/actions-netlify Instead"}),"\n",(0,l.jsx)(n.p,{children:"For simpler cases without monorepo issues:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"- name: Deploy to Netlify\n  uses: nwtgck/actions-netlify@v3.0\n  with:\n    publish-dir: ./out\n    production-deploy: true\n    github-token: ${{ secrets.GITHUB_TOKEN }}\n    deploy-message: 'Deploy - ${{ github.sha }}'\n  env:\n    NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}\n    NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID }}\n  timeout-minutes: 5\n"})}),"\n",(0,l.jsx)(n.p,{children:"Note: This action may not handle monorepo scenarios well - use CLI directly for those cases."}),"\n",(0,l.jsxs)(n.h2,{id:"local-development-with-netlify-dev",children:["Local Development with ",(0,l.jsx)(n.code,{children:"netlify dev"})]}),"\n",(0,l.jsx)(n.h3,{id:"basic-usage-monorepo",children:"Basic Usage (Monorepo)"}),"\n",(0,l.jsxs)(n.p,{children:["In a monorepo, ",(0,l.jsx)(n.code,{children:"netlify dev"})," requires ",(0,l.jsx)(n.code,{children:"--filter"})," to select the project. Without it, the CLI enters an interactive project selection prompt that blocks non-interactive environments:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# This works - selects the correct package\nnetlify dev --functions=netlify/functions --offline --filter takazudo-modular\n\n# This gets stuck at interactive prompt\nnetlify dev --functions=netlify/functions --offline\n"})}),"\n",(0,l.jsxs)(n.p,{children:["A typical ",(0,l.jsx)(n.code,{children:"package.json"})," script:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "netlify:dev": "PNPM_DISABLE_TRUST_STORE=true pnpm --package=netlify-cli dlx netlify dev --functions=netlify/functions --offline --filter takazudo-modular"\n}\n'})}),"\n",(0,l.jsxs)(n.h3,{id:"what-netlify-dev-does",children:["What ",(0,l.jsx)(n.code,{children:"netlify dev"})," Does"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Starts your framework's dev server (e.g., Next.js on port 34434)"}),"\n",(0,l.jsx)(n.li,{children:"Starts a Netlify Functions server"}),"\n",(0,l.jsxs)(n.li,{children:["Runs a proxy on ",(0,l.jsx)(n.strong,{children:"port 8888"})," that routes:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Page requests \u2192 framework dev server"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"/.netlify/functions/*"})," \u2192 functions server"]}),"\n",(0,l.jsxs)(n.li,{children:["Applies ",(0,l.jsx)(n.code,{children:"netlify.toml"})," redirect rules (e.g., ",(0,l.jsx)(n.code,{children:"/api/products"})," \u2192 ",(0,l.jsx)(n.code,{children:"/.netlify/functions/get-products"}),")"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Injects ",(0,l.jsx)(n.code,{children:".env"})," variables into the environment"]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"pnpm-10x-trust-store-error-with-dlx",children:["pnpm 10.x Trust Store Error with ",(0,l.jsx)(n.code,{children:"dlx"})]}),"\n",(0,l.jsxs)(n.p,{children:["On pnpm 10.x, ",(0,l.jsx)(n.code,{children:"pnpm dlx netlify-cli"})," may fail with:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'ERR_PNPM_TRUST_DOWNGRADE  High-risk trust downgrade for "@netlify/edge-bundler@14.9.5"\n'})}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"PNPM_DISABLE_TRUST_STORE=true"})," env var may ",(0,l.jsx)(n.strong,{children:"not"})," work with ",(0,l.jsx)(n.code,{children:"pnpm dlx"})," even though ",(0,l.jsx)(n.code,{children:"pnpm config list"})," shows ",(0,l.jsx)(n.code,{children:"trust-store=false"}),". This is a pnpm 10.x behavior where ",(0,l.jsx)(n.code,{children:"dlx"})," creates its own install context."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Workarounds"}),":"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Install netlify-cli globally"})," instead of using ",(0,l.jsx)(n.code,{children:"pnpm dlx"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm install -g netlify-cli\nnetlify dev --functions=netlify/functions --offline --filter takazudo-modular\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use npx"})," (if the global install exists):"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npx netlify-cli dev --functions=netlify/functions --offline --filter takazudo-modular\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"netlify-dev-crash-workaround",children:[(0,l.jsx)(n.code,{children:"netlify dev"})," Crash Workaround"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"netlify dev"}),' may crash with "Netlify CLI has terminated unexpectedly" after the proxy starts (observed in v23.14.0+). The proxy on port 8888 starts successfully but terminates immediately.']}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Workaround: Run functions separately"})}),"\n",(0,l.jsxs)(n.p,{children:["Use ",(0,l.jsx)(n.code,{children:"netlify functions:serve"})," to run just the functions server on ",(0,l.jsx)(n.strong,{children:"port 9999"}),", then run your framework dev server separately:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Terminal 1: Start functions server (port 9999)\nnetlify functions:serve --functions=netlify/functions --offline --filter takazudo-modular\n\n# Terminal 2: Start Next.js dev server (port 34434)\npnpm dev\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Limitation"}),": Without the ",(0,l.jsx)(n.code,{children:"netlify dev"})," proxy, API rewrites from ",(0,l.jsx)(n.code,{children:"netlify.toml"})," (e.g., ",(0,l.jsx)(n.code,{children:"/api/products"})," \u2192 ",(0,l.jsx)(n.code,{children:"/.netlify/functions/get-products"}),") won't work. The functions are accessible directly at:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"http://localhost:9999/.netlify/functions/<function-name>\n"})}),"\n",(0,l.jsxs)(n.p,{children:["For frameworks with ",(0,l.jsx)(n.code,{children:"output: 'export'"})," (static site generation), Next.js ",(0,l.jsx)(n.code,{children:"rewrites()"})," cannot be used. In this case, test the functions directly at the port 9999 URL."]}),"\n",(0,l.jsxs)(n.h3,{id:"netlify-functionsserve-vs-netlify-dev",children:[(0,l.jsx)(n.code,{children:"netlify functions:serve"})," vs ",(0,l.jsx)(n.code,{children:"netlify dev"})]}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Feature"}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.code,{children:"netlify dev"})}),(0,l.jsx)(n.th,{children:(0,l.jsx)(n.code,{children:"netlify functions:serve"})})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Port"}),(0,l.jsx)(n.td,{children:"8888 (proxy)"}),(0,l.jsx)(n.td,{children:"9999"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Framework dev server"}),(0,l.jsx)(n.td,{children:"Auto-started"}),(0,l.jsx)(n.td,{children:"Must start separately"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:["API rewrites (",(0,l.jsx)(n.code,{children:"netlify.toml"}),")"]}),(0,l.jsx)(n.td,{children:"Applied"}),(0,l.jsx)(n.td,{children:"Not applied"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:".env"})," injection"]}),(0,l.jsx)(n.td,{children:"Yes"}),(0,l.jsx)(n.td,{children:"Yes"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Stability"}),(0,l.jsx)(n.td,{children:"May crash (v23+)"}),(0,l.jsx)(n.td,{children:"Stable"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:"--filter"})," flag"]}),(0,l.jsx)(n.td,{children:"Supported"}),(0,l.jsx)(n.td,{children:"Supported"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},3351(e,n,i){i.d(n,{R:()=>o,x:()=>s});var t=i(2128);const l={},r=t.createContext(l);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);