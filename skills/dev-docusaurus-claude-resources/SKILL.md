---
name: dev-docusaurus-claude-resources
description: >-
  Add a Claude Code resources documentation section to a Docusaurus site. Auto-discovers and
  generates browsable docs for CLAUDE.md files, commands, skills, and agents with autogenerated
  sidebar navigation and hot reload support. Use when: (1) User wants to document Claude Code
  resources in Docusaurus, (2) User says 'add claude resources', 'claude docs section', or 'show
  commands and skills', (3) User wants a navigable sidebar for Claude Code components.
---

# Docusaurus Claude Resources

Add a documentation section to a Docusaurus site that auto-discovers and renders all Claude Code resources as browsable pages with autogenerated sidebar navigation.

Generates docs for four resource types:
- **CLAUDE.md** - All CLAUDE.md files found recursively in the project
- **Commands** - Custom slash commands from `commands/*.md` (frontmatter: `description`)
- **Skills** - Skill packages from `skills/*/SKILL.md` (frontmatter: `name`, `description`), including nested reference pages
- **Agents** - Custom subagents from `agents/*.md` (frontmatter: `name`, `description`, `model`)

Empty categories are automatically hidden from the sidebar.

## Prerequisites

- Docusaurus v3.x project
- `gray-matter` npm package (for YAML frontmatter parsing)

## Implementation Steps

### Step 1: Detect Docusaurus Root

Find the Docusaurus project root by locating `docusaurus.config.ts` or `docusaurus.config.js`. Store this as `{DOCUSAURUS_ROOT}`.

Also identify the Claude Code configuration directory. This is typically a `.claude/` subdirectory in the project root containing `commands/`, `skills/`, and `agents/`.

### Step 2: Install dependency

```bash
cd {DOCUSAURUS_ROOT}
npm install --save-dev gray-matter
```

### Step 3: Create the generation script

Read `assets/generate-claude-docs.js` from this skill directory and copy it to `{DOCUSAURUS_ROOT}/scripts/generate-claude-docs.js`.

Then adjust the **Configuration** section at the top of the script:

```javascript
// Where Claude Code resources live (commands/, skills/, agents/)
// For projects with .claude/ subdirectory, point to that directory
const CLAUDE_DIR = path.resolve(__dirname, "../../.claude");

// Project root for CLAUDE.md file discovery (scanned recursively)
const PROJECT_ROOT = path.resolve(__dirname, "../..");

// Docusaurus root (where docusaurus.config.js lives)
const DOCUSAURUS_ROOT = path.resolve(__dirname, "..");

// Doc prefix used in output path
const DOCS_PREFIX = "claude";

// Label shown in index page
const SECTION_LABEL = "Claude";
```

Key configuration:
- **`CLAUDE_DIR`**: Must point to the directory containing `commands/`, `skills/`, `agents/`. For most projects this is `{PROJECT_ROOT}/.claude`. Adjust the relative path based on where the Docusaurus site lives within the project.
- **`PROJECT_ROOT`**: The project root where CLAUDE.md files are searched recursively. Kept separate from `CLAUDE_DIR` so that CLAUDE.md files at the project root are discovered while commands/skills/agents are read from `.claude/`.
- **`DOCS_PREFIX`**: Controls the output directory under `docs/`. Default `"claude"` produces `docs/claude/`.
- **`SECTION_LABEL`**: The heading shown on the index page.

### Step 4: Configure autogenerated sidebar

Use Docusaurus's native `autogenerated` sidebar instead of manually built JSON. Update `{DOCUSAURUS_ROOT}/sidebars.js`:

```javascript
const sidebars = {
  claudeSidebar: [{ type: 'autogenerated', dirName: 'claude' }],
};

module.exports = sidebars;
```

If the project already has sidebars, merge `claudeSidebar` into the existing exports object.

#### Category ordering

Create `_category_.json` files in each generated category directory to control sidebar order:

```json
// docs/claude/claudemd/_category_.json
{ "position": 2, "label": "CLAUDE.md" }

// docs/claude/agents/_category_.json
{ "position": 3, "label": "Agents" }

// docs/claude/commands/_category_.json
{ "position": 4, "label": "Commands" }

// docs/claude/skills/_category_.json
{ "position": 5, "label": "Skills" }
```

**Important:** The generation script's `removeStaleItems` function must preserve `_category_.json` files. Add them to the expected files set:

```javascript
expectedFiles.add("_category_.json");
```

Each category's `index.mdx` should have `sidebar_position: 1` so it appears first within its category.

### Step 5: Add navbar item (optional)

In `{DOCUSAURUS_ROOT}/docusaurus.config.js` (or `.ts`), add a navbar item:

```javascript
navbar: {
  items: [
    {
      type: "doc",
      docId: "claude/index",
      position: "left",
      label: "Claude",
    },
  ],
},
```

Or omit navbar items and use `routeBasePath: "/"` to make the docs the homepage (see dev-docusaurus skill for details).

### Step 6: Add npm scripts

Add generation scripts to `{DOCUSAURUS_ROOT}/package.json`:

```json
{
  "scripts": {
    "generate": "node scripts/generate-claude-docs.js",
    "prestart": "npm run generate",
    "prebuild": "npm run generate"
  }
}
```

This ensures docs are regenerated before every dev server start and production build.

### Step 7: Add generated files to .gitignore

Add to `{DOCUSAURUS_ROOT}/.gitignore`:

```
# Generated Claude Code docs
docs/claude/
```

These files are regenerated on every build, so they should not be committed.

### Step 8: Verify

1. Run the generation: `node {DOCUSAURUS_ROOT}/scripts/generate-claude-docs.js`
2. Check that `{DOCUSAURUS_ROOT}/docs/claude/` contains generated MDX files
3. Start the dev server and verify:
- Sidebar shows categories (CLAUDE.md, Commands, Skills, Agents)
- Each resource page renders correctly

## How It Works

The generation script runs before Docusaurus starts and:

1. **Discovers** source files by scanning the Claude Code config directory (skips broken symlinks gracefully)
2. **Parses** YAML frontmatter using `gray-matter` to extract metadata (name, description, model)
3. **Escapes** content for MDX compatibility (angle brackets that look like JSX tags)
4. **Generates** individual MDX pages for each resource, plus index pages per category
5. **Removes stale files** — writes new files first, then removes items not in the expected set (avoids transient missing-file errors)
6. **Hides** empty categories automatically (if no commands exist, the Commands category is omitted)

Skills with `references/*.md` subdirectories become nested sidebar categories, with each reference as a child page.

## Hot Reload with File Watcher

For live development, add a file watcher that regenerates docs when source files change. Docusaurus's built-in file watching picks up the regenerated files automatically.

### writeFileIfChanged optimization

The generation script should only write files whose content actually changed. This is critical for Docusaurus HMR:

```javascript
function writeFileIfChanged(filePath, content) {
  if (fs.existsSync(filePath)) {
    const existing = fs.readFileSync(filePath, "utf8");
    if (existing === content) return false;
  }
  fs.writeFileSync(filePath, content);
  return true;
}
```

Replace all `fs.writeFileSync` calls with `writeFileIfChanged`. This way:
- **Content edits** to existing source files → only changed `.mdx` files are written → Docusaurus does fast HMR (instant)
- **No actual changes** → zero files written → Docusaurus does nothing
- **File additions/removals** → new routes created → Docusaurus does full webpack rebuild (~20-30s, unavoidable)

### Watcher script

```javascript
// watch-claude-sources.js
const DEBOUNCE_MS = 5000;
let timer = null;

function regenerate() {
  execSync("node scripts/generate-claude-docs.js", { stdio: "inherit" });
}

function scheduleRegenerate() {
  if (timer) clearTimeout(timer);
  timer = setTimeout(regenerate, DEBOUNCE_MS);
}

// Watch source directories
fs.watch(commandsDir, { recursive: true }, scheduleRegenerate);
fs.watch(skillsDir, { recursive: true }, scheduleRegenerate);
fs.watch(agentsDir, { recursive: true }, scheduleRegenerate);
```

Key design decisions:
- **5-second debounce** — batches rapid edits into a single regeneration
- **No dev server restart** — the watcher only regenerates docs; Docusaurus's own file watcher handles the rest
- Run watcher as a detached background process alongside the Docusaurus dev server

### Dev server start script

```javascript
// start-dev.js
// 1. Run initial generation
execSync("npm run generate", { cwd: SITE_DIR, stdio: "inherit" });

// 2. Start Docusaurus dev server (foreground)
const docusaurus = spawn("npx", ["docusaurus", "start"], {
  cwd: SITE_DIR, stdio: "inherit",
});

// 3. Start watcher (background, only regenerates docs)
const watcher = spawn(process.execPath, ["scripts/watch-claude-sources.js"], {
  cwd: SITE_DIR, stdio: "inherit", detached: true,
});
watcher.unref();
```

## Assets

- `assets/generate-claude-docs.js` - The generation script. Copy to `{DOCUSAURUS_ROOT}/scripts/generate-claude-docs.js` and adjust the Configuration section at the top.
